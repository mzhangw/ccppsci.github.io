<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="CCPP SciDoc" />
<meta property="og:image" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta property="og:description" content="CCPP Scientific Documentation" />
<meta property="og:url" content="https://github.com/ufs-community/ccpp-physics" />
<!-- END opengraph metadata -->
<title>CCPP SciDoc v7.0.0: GFS Surface Layer Scheme</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-ccpp.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/ufs-community/ccpp-physics" class="github-corner" title="View source on GitHub" target="_blank" rel="noopener noreferrer">
    <svg viewBox="0 0 250 250" width="60" height="60" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="dtc_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CCPP SciDoc v7.0.0
   &#160;<span id="projectnumber">v7.0.0</span>
   </div>
   <div id="projectbrief">Common Community Physics Package Developed at DTC</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('_g_f_s__s_f_c_l_y_r.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">GFS Surface Layer Scheme </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1 class="doxsection"><a class="anchor" id="des_rough"></a>
Description</h1>
<p>The lowest model layer is assumed to be the surface layer and apply the Monin-Obukhov similarity profile relationship to obtain the surface stress and sensible and latent heat fluxes. The formulation was based on Miyakoda and Sirutis (1986) <a class="el" href="citelist.html#CITEREF_miyakoda_and_sirutis_1986">[142]</a> and has been modified by P. Long <a class="el" href="citelist.html#CITEREF_long_1984">[125]</a> <a class="el" href="citelist.html#CITEREF_long_1986">[126]</a> in the very stable and very unstable situations.</p>
<p><a class="el" href="group___noah___l_s_m.html" title="GFS Noah LSM Model">GFS Noah LSM Model</a> are largely responsible for the quality of model forecasts produced for near-surface weather parameters, such as 2-meter air temperature ( \(T_{2m}\)) and surface skin temperature ( \(LST\)). \(LST\) is derived from the surface energy budget, and is particularly important to remote sensing and data assimilation. How precise these two parameters can be simulated by the model strongly depends on how accurate the surface heat fluxes are parameterized, particularly the surface sensible heat flux ( \(SH\)). The surface thermal roughness length is a key parameter to determine \(SH\). Previous GFS version do not distinguish between the roughness length for heat and momentum. The aerodynamic roughness \(Z_{0m}\) is used for wind, while the thermal roughness \(Z_{0t}\) is used for heat and water vapor. In the surface layer, the GFS applies the MO similarity profile scheme with modified stability functions (Miyakoda and Sirutis 1986 <a class="el" href="citelist.html#CITEREF_miyakoda_and_sirutis_1986">[142]</a>; Long 1984, 1986 <a class="el" href="citelist.html#CITEREF_long_1984">[125]</a> <a class="el" href="citelist.html#CITEREF_long_1986">[126]</a>). Momentum and thermal roughness lengths are necessary to estimate the surface fluxes from the atmospheric surface layer similarity theory. In the current operational GFS, the momentum roughtness length \(Z_{0m}\) is specified according to the fixed vegetation types but has no seasonal variation.</p>
<p>In May 2011, the new vegetation-dependent formulations of thermal roughness formulation ( Zheng et al. (2012) <a class="el" href="citelist.html#CITEREF_zheng_et_al_2012">[216]</a>) was implemented to deal with the cold \(LST\) bias over the arid western continental United States (CONUS) during daytime. The thermal roughness length \(Z_{0H}\) is derived by a seasonlly varying formulation dependent on the seasonal cycle of green vegetation fraction. In this \(Z_{0H}\) formulation, a key parameter known as \(C_{zil}\) is specified according to a dependence on canopy height.</p>
<p>The NCEP GFS global prediction model has experienced a longstanding problem of severe cold bias in the \(T_{2m}\) forecasts over land in the late afternoon and nighttime during moist seasons. This cold bias is closely associated with the nocturnal stable boundary layer and is accompanied by a corresponding warm air temperature bias in the first model level above the ground. In 2017, Zheng et al. (2017) <a class="el" href="citelist.html#CITEREF_zheng_et_al_2017">[217]</a> identified the bias and introduced a stability parameter constraint \((z/L)_{lim}\) to prevent the land-atmosphere system from fully decoupling:   </p><p class="formulaDsp">
\[(z/L)_{lim}=\frac{ln(\frac{z}{z_{0M}})}{2\alpha(1-\frac{z_{0M}}{z})}
\]
</p>
<p>Here \(z\) is the height, \(L\) is the Obukhov length, \(z_{0M}\) is the momentum roughness length, and \(\alpha = 5\).</p>
<p>The pertinent features of the GFS stable surface layer parameterization scheme are described in the appendix of Zheng et al. (2017) <a class="el" href="citelist.html#CITEREF_zheng_et_al_2017">[217]</a>.</p>
<p>Recently, Han et al.(2021) <a class="el" href="citelist.html#CITEREF_https://doi.org/10.25923/cybh-w893">[84]</a> and Han et al.(2022) <a class="el" href="citelist.html#CITEREF_han_et_al_2022">[82]</a> introduced a few new features:</p><ul>
<li>A new canopy heat storage algorithm was implemented. The reduction of the sensible heat flux into the PBL, as a function of surface roughness and vegetation fraction, helps to reduce nighttime cold and daytime warm 2-meter temperature biases over forested regions.</li>
<li>A sea spray effect algorithm was included to enhance sensible and latent heat fluxes, especially for strong wind conditions.</li>
<li>To better represent sub-grid scale turbulence variability in the surface layer, a new algorithm for maximum surface layer stability parameter was developed as an inverse function of the background turbulent eddy diffusivity.</li>
<li>The thermal roughness length calculation over land has been modified.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="intra_rough"></a>
Intraphysics Communication</h1>
<p><a class="el" href="group___g_f_s__diff__main.html#arg_table_sfc_diff_run" title="Argument Table">Argument Table</a></p>
<h1 class="doxsection"><a class="anchor" id="gen_rough"></a>
General Algorithm</h1>
<p><a class="el" href="group___g_f_s__diff__main.html#general_diff" title="GFS Surface Layer Scheme General Algorithm">GFS Surface Layer Scheme General Algorithm</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
    toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
    toggleButton.title = "Toggle Light/Dark Mode"
    $(document).ready(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
    // every resize will remove the button, which is why it has to be added again:
    $(window).resize(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
  })
</script>
</body>
</html>
