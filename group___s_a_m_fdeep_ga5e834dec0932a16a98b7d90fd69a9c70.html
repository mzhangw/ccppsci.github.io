<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="CCPP SciDoc" />
<meta property="og:image" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta property="og:description" content="CCPP Scientific Documentation" />
<meta property="og:url" content="https://github.com/ufs-community/ccpp-physics" />
<!-- END opengraph metadata -->
<title>CCPP SciDoc v7.0.0: samfdeepcnv::samfdeepcnv_run</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-ccpp.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/ufs-community/ccpp-physics" class="github-corner" title="View source on GitHub" target="_blank" rel="noopener noreferrer">
    <svg viewBox="0 0 250 250" width="60" height="60" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="dtc_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CCPP SciDoc v7.0.0
   &#160;<span id="projectnumber">v7.0.0</span>
   </div>
   <div id="projectbrief">Common Community Physics Package Developed at DTC</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('group___s_a_m_fdeep_ga5e834dec0932a16a98b7d90fd69a9c70.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="contents">
<a id="ga5e834dec0932a16a98b7d90fd69a9c70" name="ga5e834dec0932a16a98b7d90fd69a9c70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5e834dec0932a16a98b7d90fd69a9c70">&#9670;&#160;</a></span>samfdeepcnv_run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine samfdeepcnv::samfdeepcnv_run </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>im</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>km</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)</td>          <td class="paramname"><span class="paramname"><em>first_time_step</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)</td>          <td class="paramname"><span class="paramname"><em>restart</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:,:), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tmf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(in), optional</td>          <td class="paramname"><span class="paramname"><em>qmicro</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>itc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>ntc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>cliq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>cp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>cvap</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>eps</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>epsm1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>fv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>grav</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>hvap</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>rd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>rv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t0c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>delt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>ntk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>ntr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(in)</td>          <td class="paramname"><span class="paramname"><em>delp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(in)</td>          <td class="paramname"><span class="paramname"><em>prslp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:), intent(in)</td>          <td class="paramname"><span class="paramname"><em>psp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(in)</td>          <td class="paramname"><span class="paramname"><em>phil</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tkeh</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:,:), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>qtr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(in), optional</td>          <td class="paramname"><span class="paramname"><em>prevsq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(in)</td>          <td class="paramname"><span class="paramname"><em>q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>q1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>t1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>u1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>v1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:), intent(in)</td>          <td class="paramname"><span class="paramname"><em>fscav</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)</td>          <td class="paramname"><span class="paramname"><em>hwrf_samfdeep</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)</td>          <td class="paramname"><span class="paramname"><em>progsigma</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)</td>          <td class="paramname"><span class="paramname"><em>progomega</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:), intent(out)</td>          <td class="paramname"><span class="paramname"><em>cldwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:), intent(out)</td>          <td class="paramname"><span class="paramname"><em>rn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(out)</td>          <td class="paramname"><span class="paramname"><em>kbot</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ktop</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>kcnv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)</td>          <td class="paramname"><span class="paramname"><em>islimsk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:), intent(in)</td>          <td class="paramname"><span class="paramname"><em>garea</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(in)</td>          <td class="paramname"><span class="paramname"><em>dot</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>ncloud</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:), intent(in)</td>          <td class="paramname"><span class="paramname"><em>hpbl</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ud_mf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(out)</td>          <td class="paramname"><span class="paramname"><em>dd_mf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(out)</td>          <td class="paramname"><span class="paramname"><em>dt_mf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>cnvw</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>cnvc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(inout), optional</td>          <td class="paramname"><span class="paramname"><em>qlcn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(inout), optional</td>          <td class="paramname"><span class="paramname"><em>qicn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(inout), optional</td>          <td class="paramname"><span class="paramname"><em>w_upi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(inout), optional</td>          <td class="paramname"><span class="paramname"><em>cf_upi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(inout), optional</td>          <td class="paramname"><span class="paramname"><em>cnv_mfd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(inout), optional</td>          <td class="paramname"><span class="paramname"><em>cnv_dqldt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(inout), optional</td>          <td class="paramname"><span class="paramname"><em>clcn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(inout), optional</td>          <td class="paramname"><span class="paramname"><em>cnv_fice</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(inout), optional</td>          <td class="paramname"><span class="paramname"><em>cnv_ndrop</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(inout), optional</td>          <td class="paramname"><span class="paramname"><em>cnv_nice</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>mp_phys</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>mp_phys_mg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>clam</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c0s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>betal</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>betas</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>evef</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>pgcon</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>asolfac</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>cscale</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)</td>          <td class="paramname"><span class="paramname"><em>do_ca</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)</td>          <td class="paramname"><span class="paramname"><em>ca_closure</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)</td>          <td class="paramname"><span class="paramname"><em>ca_entr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)</td>          <td class="paramname"><span class="paramname"><em>ca_trigger</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nthresh</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:), intent(in), optional</td>          <td class="paramname"><span class="paramname"><em>ca_deep</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:), intent(out)</td>          <td class="paramname"><span class="paramname"><em>rainevap</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(in), optional</td>          <td class="paramname"><span class="paramname"><em>sigmain</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(inout), optional</td>          <td class="paramname"><span class="paramname"><em>sigmaout</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(in), optional</td>          <td class="paramname"><span class="paramname"><em>omegain</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(:,:), intent(inout), optional</td>          <td class="paramname"><span class="paramname"><em>omegaout</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>betadcu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>betamcu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>betascu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension (:), intent(in), optional</td>          <td class="paramname"><span class="paramname"><em>maxmf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)</td>          <td class="paramname"><span class="paramname"><em>do_mynnedmf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)</td>          <td class="paramname"><span class="paramname"><em>sigmab_coldstart</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(out)</td>          <td class="paramname"><span class="paramname"><em>errmsg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)</td>          <td class="paramname"><span class="paramname"><em>errflg</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<h2 class="doxsection"><a class="anchor" id="autotoc_md7"></a>
Determine whether to perform aerosol transport</h2>
<h2 class="doxsection"><a class="anchor" id="autotoc_md8"></a>
Compute preliminary quantities needed for static, dynamic, and feedback control portions of the algorithm.</h2>
<ul>
<li>Convert input pressure terms to centibar units.</li>
</ul>
<ul>
<li>Initialize column-integrated and other single-value-per-column variable arrays.</li>
</ul>
<ul>
<li>determine aerosol-aware rain conversion parameter over land</li>
</ul>
<ul>
<li>determine rain conversion parameter above the freezing level which exponentially decreases with decreasing temperature from Han et al.'s (2017) <a class="el" href="citelist.html#CITEREF_han_et_al_2017">[80]</a> equation 8.</li>
</ul>
<ul>
<li>Initialize convective cloud water and cloud cover to zero.</li>
</ul>
<ul>
<li>Initialize updraft and downdraft mass fluxes to zero.</li>
</ul>
<ul>
<li>Determine maximum indices for the parcel starting point (kbm), LFC (kbmax), and cloud top (kmax).</li>
</ul>
<ul>
<li>Calculate hydrostatic height at layer centers assuming a flat surface (no terrain) from the geopotential.</li>
</ul>
<ul>
<li>Calculate interface height</li>
</ul>
<ul>
<li>Convert prsl from centibar to millibar, set normalized mass fluxes to 1, cloud properties to 0, and save model state variables (after advection/turbulence).</li>
</ul>
<ul>
<li>Calculate saturation specific humidity and enforce minimum moisture values.</li>
</ul>
<ul>
<li>Calculate moist static energy (heo) and saturation moist static energy (heso).</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md9"></a>
Perform calculations related to the updraft of the entraining/detraining cloud model ("static control").</h2>
<ul>
<li>Find the index for a level of sfclfac*hpbl which is initial guess for the parcel starting level.</li>
</ul>
<ul>
<li>Search below index "kbm" and above kb1 for the level of maximum moist static energy. <br  />
</li>
</ul>
<ul>
<li>Calculate the temperature, specific humidity, and pressure at interface levels.</li>
</ul>
<ul>
<li>Recalculate saturation specific humidity, moist static energy, saturation moist static energy, and horizontal momentum on interface levels. Enforce minimum specific humidity and calculate \((1 - RH)\).</li>
</ul>
<ul>
<li>Search below the index "kbmax" for the level of free convection (LFC) where the condition \(h_b &gt; h^*\) is first met, where \(h_b, h^*\) are the state moist static energy at the parcel's starting level and saturation moist static energy, respectively. Set "kbcon" to the index of the LFC.</li>
</ul>
<ul>
<li>If no LFC, return to the calling routine without modifying state variables.</li>
</ul>
<ul>
<li>Determine the vertical pressure velocity at the LFC. After Han and Pan (2011) <a class="el" href="citelist.html#CITEREF_han_and_pan_2011">[78]</a> , determine the maximum pressure thickness between a parcel's starting level and the LFC. If a parcel doesn't reach the LFC within the critical thickness, then the convective inhibition is deemed too great for convection to be triggered, and the subroutine returns to the calling routine without modifying the state variables.</li>
</ul>
<ul>
<li>if the mean relative humidity in the subcloud layers is less than a threshold value (rhcrt), convection is not triggered.</li>
</ul>
<ul>
<li>In HWRF samfdeep, calculate the entrainment rate according to Han and Pan (2011) <a class="el" href="citelist.html#CITEREF_han_and_pan_2011">[78]</a> , equation 8, after Bechtold et al. (2008) <a class="el" href="citelist.html#CITEREF_bechtold_et_al_2008">[12]</a>, equation 2 given by:   <p class="formulaDsp">
\[     \epsilon = \epsilon_0F_0 + d_1\left(1-RH\right)F_1
\]
</p>
 where \(\epsilon_0\) is the cloud base entrainment rate, \(d_1\) is a tunable constant, and \(F_0=\left(\frac{q_s}{q_{s,b}}\right)^2\) and \(F_1=\left(\frac{q_s}{q_{s,b}}\right)^3\) where \(q_s\) and \(q_{s,b}\) are the saturation specific humidities at a given level and cloud base, respectively. The detrainment rate in the cloud is assumed to be equal to the entrainment rate at cloud base.</li>
</ul>
<ul>
<li>The updraft detrainment rate is vertically constant and proportional to clamt</li>
</ul>
<ul>
<li>Calculate the normalized mass flux for subcloud and in-cloud layers according to Pan and Wu (1995) <a class="el" href="citelist.html#CITEREF_pan_and_wu_1995">[160]</a> equation 1:   <p class="formulaDsp">
\[     \frac{1}{\eta}\frac{\partial \eta}{\partial z} = \lambda_e - \lambda_d
\]
</p>
 where \(\eta\) is the normalized mass flux, \(\lambda_e\) is the entrainment rate and \(\lambda_d\) is the detrainment rate.</li>
</ul>
<ul>
<li>Set cloud properties equal to the state variables at updraft starting level (kb).</li>
</ul>
<ul>
<li>Calculate the cloud properties as a parcel ascends, modified by entrainment and detrainment. Discretization follows Appendix B of Grell (1993) <a class="el" href="citelist.html#CITEREF_grell_1993">[73]</a> . Following Han and Pan (2006) <a class="el" href="citelist.html#CITEREF_han_and_pan_2006">[77]</a>, the convective momentum transport is reduced by the convection-induced pressure gradient force by the constant "pgcon", currently set to 0.55 after Zhang and Wu (2003) <a class="el" href="citelist.html#CITEREF_zhang_and_wu_2003">[215]</a> .</li>
</ul>
<ul>
<li>With entrainment, recalculate the LFC as the first level where buoyancy is positive. The difference in pressure levels between LFCs calculated with/without entrainment must be less than a threshold (currently 25 hPa). Otherwise, convection is inhibited and the scheme returns to the calling routine without modifying the state variables. This is the subcloud dryness trigger modification discussed in Han and Pan (2011) <a class="el" href="citelist.html#CITEREF_han_and_pan_2011">[78]</a>.</li>
</ul>
<ul>
<li>Calculate additional trigger condition of the convective inhibition (CIN) according to Han et al.'s (2017) <a class="el" href="citelist.html#CITEREF_han_et_al_2017">[80]</a> equation 13.</li>
</ul>
<ul>
<li>Turn off convection if the CIN is less than a critical value (cinacr) which is inversely proportional to the large-scale vertical velocity.</li>
</ul>
<ul>
<li>Calculate the cloud top as the first level where parcel buoyancy becomes negative. If the thickness of the calculated convection is less than a threshold (currently 200 hPa), then convection is inhibited, and the scheme returns to the calling routine.</li>
</ul>
<ul>
<li>To originate the downdraft, search for the level above the minimum in moist static energy. Return to the calling routine without modification if this level is determined to be outside of the convective cloud layers.</li>
</ul>
<ul>
<li>Calculate the maximum value of the cloud base mass flux using the CFL-criterion-based formula of Han and Pan (2011) <a class="el" href="citelist.html#CITEREF_han_and_pan_2011">[78]</a>, equation 7.</li>
</ul>
<ul>
<li>Set cloud moisture property equal to the enviromental moisture at updraft starting level (kb).</li>
</ul>
<ul>
<li>Calculate the moisture content of the entraining/detraining parcel (qcko) and the value it would have if just saturated (qrch), according to equation A.14 in Grell (1993) <a class="el" href="citelist.html#CITEREF_grell_1993">[73]</a> . Their difference is the amount of convective cloud water (qlk = rain + condensate). Determine the portion of convective cloud water that remains suspended and the portion that is converted into convective precipitation (pwo). Calculate and save the negative cloud work function (aa1) due to water loading. The liquid water in the updraft layer is assumed to be detrained from the layers above the level of the minimum moist static energy into the grid-scale cloud water (dellal).</li>
</ul>
<ul>
<li>Calculate the cloud work function according to Pan and Wu (1995) <a class="el" href="citelist.html#CITEREF_pan_and_wu_1995">[160]</a> equation 4:   <p class="formulaDsp">
\[     A_u=\int_{z_0}^{z_t}\frac{g}{c_pT(z)}\frac{\eta}{1 + \gamma}[h(z)-h^*(z)]dz
\]
</p>
 (discretized according to Grell (1993) <a class="el" href="citelist.html#CITEREF_grell_1993">[73]</a> equation B.10 using B.2 and B.3 of Arakawa and Schubert (1974) <a class="el" href="citelist.html#CITEREF_arakawa_and_schubert_1974">[6]</a> and assuming \(\eta=1\)) where \(A_u\) is the updraft cloud work function, \(z_0\) and \(z_t\) are cloud base and cloud top, respectively, \(\gamma = \frac{L}{c_p}\left(\frac{\partial \overline{q_s}}{\partial T}\right)_p\) and other quantities are previously defined.</li>
</ul>
<ul>
<li>If the updraft cloud work function is negative, convection does not occur, and the scheme returns to the calling routine.</li>
</ul>
<ul>
<li>Continue calculating the cloud work function past the point of neutral buoyancy to represent overshooting according to Han and Pan (2011) <a class="el" href="citelist.html#CITEREF_han_and_pan_2011">[78]</a> . Convective overshooting stops when \( cA_u &lt; 0\) where \(c\) is currently 10%, or when 10% of the updraft cloud work function has been consumed by the stable buoyancy force.</li>
</ul>
<ul>
<li>For the overshooting convection, calculate the moisture content of the entraining/detraining parcel as before. Partition convective cloud water and precipitation and detrain convective cloud water above the mimimum in moist static energy.</li>
</ul>
<ul>
<li>Calculate diagnostic updraft velocity square(wu2) according to Han et al.'s (2017) <a class="el" href="citelist.html#CITEREF_han_et_al_2017">[80]</a> equation 7.</li>
<li>if progomega = true, calculate prognostic updraft velocity (Pa/s) according to progomega routine.</li>
</ul>
<ul>
<li>Calculate the mean updraft velocity within the cloud (wc).</li>
</ul>
<ul>
<li>For progsigma = T, calculate the mean updraft velocity within the cloud (omegac),cast in pressure coordinates. <br  />
</li>
</ul>
<ul>
<li>For progsigma = T, calculate the xi term in Bengtsson et al. 2022 <a class="el" href="citelist.html#CITEREF_bengtsson_2022">[16]</a> (equation 8)</li>
</ul>
<ul>
<li>Swap the indices of the convective cloud top (ktcon) and the overshooting convection top (ktcon1) to use the same cloud top level in the calculations of \(A^+\) and \(A^*\).</li>
</ul>
<ul>
<li>Separate the total updraft cloud water at cloud top into vapor and condensate.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md10"></a>
Perform calculations related to the downdraft of the entraining/detraining cloud model ("static control").</h2>
<ul>
<li>First, in order to calculate the downdraft mass flux (as a fraction of the updraft mass flux), calculate the wind shear and precipitation efficiency according to equation 58 in Fritsch and Chappell (1980) <a class="el" href="citelist.html#CITEREF_fritsch_and_chappell_1980">[63]</a> :   <p class="formulaDsp">
\[    E = 1.591 - 0.639\frac{\Delta V}{\Delta z} + 0.0953\left(\frac{\Delta V}{\Delta z}\right)^2 - 0.00496\left(\frac{\Delta V}{\Delta z}\right)^3
\]
</p>
 where \(\Delta V\) is the integrated horizontal shear over the cloud depth, \(\Delta z\), (the ratio is converted to units of \(10^{-3} s^{-1}\)). The variable "edto" is \(1-E\) and is constrained to the range \([0,0.9]\).</li>
</ul>
<ul>
<li>Next, calculate the variable detrainment rate between the surface and the LFC according to:   <p class="formulaDsp">
\[    \lambda_d = \frac{1-\beta^{\frac{1}{k_{LFC}}}}{\overline{\Delta z}}
\]
</p>
 \(\lambda_d\) is the detrainment rate, \(\beta\) is a constant currently set to 0.05, implying that only 5% of downdraft mass flux at LFC reaches the ground surface due to detrainment, \(k_{LFC}\) is the vertical index of the LFC level, and \(\overline{\Delta z}\) is the average vertical grid spacing below the LFC.</li>
</ul>
<ul>
<li>Calculate the normalized downdraft mass flux from equation 1 of Pan and Wu (1995) <a class="el" href="citelist.html#CITEREF_pan_and_wu_1995">[160]</a> . Downdraft entrainment and detrainment rates are constants from the downdraft origination to the level of 60mb above the ground surface (kd94).</li>
</ul>
<ul>
<li>Set initial cloud downdraft properties equal to the state variables at the downdraft origination level.</li>
</ul>
<ul>
<li>Calculate the cloud properties as a parcel descends, modified by entrainment and detrainment. Discretization follows Appendix B of Grell (1993) <a class="el" href="citelist.html#CITEREF_grell_1993">[73]</a> .</li>
</ul>
<ul>
<li>Compute the amount of moisture that is necessary to keep the downdraft saturated.</li>
</ul>
<ul>
<li>Update the precipitation efficiency (edto) based on the ratio of normalized cloud condensate (pwavo) to normalized cloud evaporate (pwevo).</li>
</ul>
<ul>
<li>Calculate downdraft cloud work function ( \(A_d\)) according to equation A.42 (discretized by B.11) in Grell (1993) <a class="el" href="citelist.html#CITEREF_grell_1993">[73]</a> . Add it to the updraft cloud work function, \(A_u\).</li>
</ul>
<ul>
<li>Check for negative total cloud work function; if found, return to calling routine without modifying state variables.</li>
</ul>
<ul>
<li>Calculate the change in moist static energy, moisture mixing ratio, and horizontal winds per unit cloud base mass flux near the surface using equations B.18 and B.19 from Grell (1993) <a class="el" href="citelist.html#CITEREF_grell_1993">[73]</a>, for all layers below cloud top from equations B.14 and B.15, and for the cloud top from B.16 and B.17.</li>
</ul>
<ul>
<li>If grid size is less than a threshold value (dxcrtas: currently 8km if progsigma is not used), or progsigma = true, the quasi-equilibrium assumption of Arakawa-Schubert is not used any longer.</li>
</ul>
<ul>
<li>If grid size is larger than the threshold value (i.e., asqecflg=.true.), the quasi-equilibrium assumption is used to obtain the cloud base mass flux. To begin with, calculate the change in the temperature and moisture profiles per unit cloud base mass flux.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md11"></a>
Using the updated temperature and moisture profiles that were modified by the convection on a short time-scale, recalculate the total cloud work function to determine the change in the cloud work function due to convection, or the stabilizing effect of the cumulus.</h2>
<ul>
<li>Using notation from Pan and Wu (1995) <a class="el" href="citelist.html#CITEREF_pan_and_wu_1995">[160]</a>, the previously calculated cloud work function is denoted by \(A^+\). Now, it is necessary to use the entraining/detraining cloud model ("static control") to determine the cloud work function of the environment after the stabilization of the arbitrary convective element (per unit cloud base mass flux) has been applied, denoted by \(A^*\).</li>
<li>Recalculate saturation specific humidity.</li>
</ul>
<ul>
<li>As before, recalculate the updraft cloud work function.</li>
</ul>
<ul>
<li>As before, recalculate the downdraft cloud work function.</li>
</ul>
<ul>
<li>Following Bechtold et al. (2008) <a class="el" href="citelist.html#CITEREF_bechtold_et_al_2008">[12]</a>, the convective adjustment time (dtconv) is set to be proportional to the convective turnover time, which is computed using the mean updraft velocity (wc) and the cloud depth. It is also proportional to the grid size (gdx).</li>
</ul>
<ul>
<li>Calculate advective time scale (tauadv) using a mean cloud layer wind speed.</li>
</ul>
<ul>
<li>From Bengtsson et al. (2022) <a class="el" href="citelist.html#CITEREF_bengtsson_2022">[16]</a> prognostic closure scheme, equation 8, call progsigma_calc() to compute updraft area fraction based on a moisture budget</li>
</ul>
<ul>
<li>From Han et al.'s (2017) <a class="el" href="citelist.html#CITEREF_han_et_al_2017">[80]</a> equation 6, calculate cloud base mass flux as a function of the mean updraft velcoity for the grid sizes where the quasi-equilibrium assumption of Arakawa-Schubert is not valid any longer. As discussed in Han et al. (2017) <a class="el" href="citelist.html#CITEREF_han_et_al_2017">[80]</a> , when dtconv is larger than tauadv, the convective mixing is not fully conducted before the cumulus cloud is advected out of the grid cell. In this case, therefore, the cloud base mass flux is further reduced in proportion to the ratio of tauadv to dtconv.</li>
</ul>
<ul>
<li>For the cases where the quasi-equilibrium assumption of Arakawa-Schubert is valid, first calculate the large scale destabilization as in equation 5 of Pan and Wu (1995) <a class="el" href="citelist.html#CITEREF_pan_and_wu_1995">[160]</a> :   <p class="formulaDsp">
\[     \frac{\partial A}{\partial t}_{LS}=\frac{A^+-cA^0}{\Delta t_{LS}}
\]
</p>
 Here \(A^0\) is set to zero following Han et al.'s (2017) <a class="el" href="citelist.html#CITEREF_han_et_al_2017">[80]</a> , implying that the instability is completely eliminated after the convective adjustment time, \(\Delta t_{LS}\).</li>
</ul>
<ul>
<li>Calculate the stabilization effect of the convection (per unit cloud base mass flux) as in equation 6 of Pan and Wu (1995) <a class="el" href="citelist.html#CITEREF_pan_and_wu_1995">[160]</a> :   <p class="formulaDsp">
\[    \frac{\partial A}{\partial t}_{cu}=\frac{A^*-A^+}{\Delta t_{cu}}
\]
</p>
 \(\Delta t_{cu}\) is the short timescale of the convection.</li>
</ul>
<ul>
<li><p class="startli">The cloud base mass flux (xmb) is then calculated from equation 7 of Pan and Wu (1995) <a class="el" href="citelist.html#CITEREF_pan_and_wu_1995">[160]</a>   </p><p class="formulaDsp">
\[    M_c=\frac{-\frac{\partial A}{\partial t}_{LS}}{\frac{\partial A}{\partial t}_{cu}}
\]
</p>
<p class="startli">Again when dtconv is larger than tauadv, the cloud base mass flux is further reduced in proportion to the ratio of tauadv to dtconv.</p>
</li>
</ul>
<ul>
<li>If the large scale destabilization is less than zero, or the stabilization by the convection is greater than zero, then the scheme returns to the calling routine without modifying the state variables.</li>
</ul>
<ul>
<li>For scale-aware parameterization, the updraft fraction (sigmagfm) is first computed as a function of the lateral entrainment rate at cloud base (see Han et al.'s (2017) <a class="el" href="citelist.html#CITEREF_han_et_al_2017">[80]</a> equation 4 and 5), following the study by Grell and Freitas (2014) <a class="el" href="citelist.html#CITEREF_grell_and_freitas_2014">[72]</a>.</li>
</ul>
<ul>
<li>Then, calculate the reduction factor (scaldfunc) of the vertical convective eddy transport of mass flux as a function of updraft fraction from the studies by Arakawa and Wu (2013) <a class="el" href="citelist.html#CITEREF_arakawa_and_wu_2013">[7]</a> (also see Han et al.'s (2017) <a class="el" href="citelist.html#CITEREF_han_et_al_2017">[80]</a> equation 1 and 2). The final cloud base mass flux with scale-aware parameterization is obtained from the mass flux when sigmagfm &lt;&lt; 1, multiplied by the reduction factor (Han et al.'s (2017) <a class="el" href="citelist.html#CITEREF_han_et_al_2017">[80]</a> equation 2).</li>
</ul>
<ul>
<li>Transport aerosols if present</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md12"></a>
For the "feedback" control, calculate updated values of the state variables by multiplying the cloud base mass flux and the tendencies calculated per unit cloud base mass flux from the static control.</h2>
<ul>
<li>Calculate the temperature tendency from the moist static energy and specific humidity tendencies.</li>
<li>Update the temperature, specific humidity, and horiztonal wind state variables by multiplying the cloud base mass flux-normalized tendencies by the cloud base mass flux.</li>
<li>Accumulate column-integrated tendencies.</li>
</ul>
<ul>
<li>Recalculate saturation specific humidity using the updated temperature.</li>
</ul>
<ul>
<li>Add up column-integrated convective precipitation by multiplying the normalized value by the cloud base mass flux.</li>
</ul>
<ul>
<li>Determine the evaporation of the convective precipitation and update the integrated convective precipitation.</li>
<li>Update state temperature and moisture to account for evaporation of convective precipitation.</li>
<li>Update column-integrated tendencies to account for evaporation of convective precipitation.</li>
</ul>
<ul>
<li>Calculate convective cloud water.</li>
</ul>
<ul>
<li>Calculate convective cloud cover, which is used when pdf-based cloud fraction is used (i.e., pdfcld=.true.).</li>
</ul>
<ul>
<li>Separate detrained cloud water into liquid and ice species as a function of temperature only.</li>
</ul>
<ul>
<li>If convective precipitation is zero or negative, reset the updated state variables back to their original values (negating convective changes).</li>
</ul>
<ul>
<li>Store aerosol concentrations if present</li>
</ul>
<ul>
<li>Calculate and retain the updraft and downdraft mass fluxes for dust transport by cumulus convection.</li>
</ul>
<ul>
<li>Calculate the updraft convective mass flux.</li>
</ul>
<ul>
<li>save the updraft convective mass flux at cloud top.</li>
</ul>
<ul>
<li>Calculate the downdraft convective mass flux.</li>
</ul>

<p class="definition">Definition at line <a class="el" href="samfdeepcnv_8f_source.html#l00076">76</a> of file <a class="el" href="samfdeepcnv_8f_source.html">samfdeepcnv.f</a>.</p>

<p class="reference">References <a class="el" href="module__sf__noahmplsm_8_f90_source.html#l01693">energy()</a>, <a class="el" href="progomega__calc_8f90_source.html#l00024">progomega::progomega_calc()</a>, and <a class="el" href="module__sf__noahmplsm_8_f90_source.html#l07047">water()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" loading="lazy" frameborder="0" src="group___s_a_m_fdeep_ga5e834dec0932a16a98b7d90fd69a9c70_ga5e834dec0932a16a98b7d90fd69a9c70_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="namespacesamfdeepcnv.html">samfdeepcnv</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
    toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
    toggleButton.title = "Toggle Light/Dark Mode"
    $(document).ready(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
    // every resize will remove the button, which is why it has to be added again:
    $(window).resize(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
  })
</script>
</body>
</html>
