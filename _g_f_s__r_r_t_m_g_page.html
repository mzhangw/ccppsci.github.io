<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="CCPP SciDoc" />
<meta property="og:image" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta property="og:description" content="CCPP Scientific Documentation" />
<meta property="og:url" content="https://github.com/ufs-community/ccpp-physics" />
<!-- END opengraph metadata -->
<title>CCPP SciDoc v7.0.0: RRTMG Shortwave/Longwave Radiation Scheme</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-ccpp.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/ufs-community/ccpp-physics" class="github-corner" title="View source on GitHub" target="_blank" rel="noopener noreferrer">
    <svg viewBox="0 0 250 250" width="60" height="60" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="dtc_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CCPP SciDoc v7.0.0
   &#160;<span id="projectnumber">v7.0.0</span>
   </div>
   <div id="projectbrief">Common Community Physics Package Developed at DTC</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('_g_f_s__r_r_t_m_g_page.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">RRTMG Shortwave/Longwave Radiation Scheme </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1 class="doxsection"><a class="anchor" id="des_rrtmg"></a>
Description</h1>
<p>Radiative processes are among the most complex and computationally intensive parts of all model physics. As an essential component of modeling the atmosphere, radiation directly and indirectly connects all physics processes with model dynamics, and it regulates the overall earth-atmosphere energy exchanges and transformations.</p>
<p>The schematic radiation module structure is shown in Figure 1. </p><div class="image">
<img src="schematic_Rad_mod.png" alt=""/>
<div class="caption">
Figure 1: Schematic Radiation Module Structure</div></div>
<p>GFS radiation package is intended to provide a fast and accurate method of determining the total radiative flux at any given location. These calculations provide both the total radiative flux at the ground surface, which is needed to establish the surface energy budget, and the vertical radiative net flux divergence, which is used to calculate the radiative heating and cooling rates of a given atmospheric layer. The magnitude of the terms in the surface energy budget can set the stage for moist deep convection and are crucial to the formation of low-level clouds. In addition, the vertical radiative flux divergence can produce substantial cooling, particularly at the tops of clouds, which can have strong dynamical effects on cloud evolution.</p>
<p>Since 2007, the longwave (LW) and the shortwave (SW) radiation parameterizations in NCEP's operational GFS are both modified and optimized versions of the Rapid Radiative Transfer Model for GCMs (RRTMG_LW and RRTMG_SW, respectively) developed at AER <em class="arg">inc</em>. (Atmospheric and Environmental Research) (Iacono et al.(2008) <a class="el" href="citelist.html#CITEREF_iacono_et_al_2008">[101]</a>; Mlawer et al.(1997) <a class="el" href="citelist.html#CITEREF_mlawer_et_al_1997">[143]</a>; Iacono et al.(2000) <a class="el" href="citelist.html#CITEREF_iacono_et_al_2000">[100]</a>; Clough et al. 2005 <a class="el" href="citelist.html#CITEREF_clough_et_al_2005">[40]</a>). The LW algorithm contains 140 unevenly distributed g-points (quadrature points) in 16 broad spectral bands, while the SW algorithm includes 112 g-points in 14 bands. In addition to the major atmospheric absorbing gases of ozone, water vapor, and carbon dioxide, the algorithm also includes various minor absorbing species such as methane, nitrous oxide, oxygen, and in the longwave up to four types of halocarbons (CFCs). To represent statistically the unresolved subgrid cloud variability when dealing multi layered clouds, a Monte-Carlo Independent Column Approximation (<b>McICA</b>) method is used in the RRTMG radiative transfer. Several cloud overlap methods, including maximum-random, exponential, and exponential-random are available in both LW and SW radiation calculations.</p>
<p>Radiative fields from model outputs ( \(W m^{-2}\)) include:</p><ul>
<li>At surface total sky<ul>
<li>DLWRFsfc: Downward LW</li>
<li>DSWRFsfc: Downward SW</li>
<li>ULWRFsfc: Upward LW</li>
<li>USWRFsfc: Upward SW</li>
<li>NBDSFsfc: Near IR beam downward</li>
<li>NDDSFsfc: Near IR diffuse downward</li>
<li>VBDSFsfc: UV+Visible beam downward</li>
<li>VDDSFsfc: UV+Visible diffuse downward</li>
<li>DUVBsfc: UV-B downward flux</li>
</ul>
</li>
<li>At surface clear sky<ul>
<li>CSDLFsfc: Downward LW</li>
<li>CSDSFsfc: Downward SW</li>
<li>CSULFsfc: Upward LW</li>
<li>CSDLFsfc: Downward LW</li>
<li>CSUSFsfc: Upward sw</li>
<li>CDUVBsfc: UV-B downward flux</li>
</ul>
</li>
<li>At TOA total sky<ul>
<li>DSWRFtoa: Downward SW</li>
<li>ULWRFtoa: Upward LW</li>
<li>USWRFtoa: Upward SW</li>
</ul>
</li>
<li>At TOA clear sky:<ul>
<li>CSULFtoa: Upward LW</li>
<li>CSUSFtoa: Upward SW</li>
</ul>
</li>
</ul>
<p>In 2022, requests have been made by many physics developers and users to rewrite the cloud routines (routines progcld) for radiation computation in the program <a class="el" href="radiation__clouds_8f_source.html">radiation_clouds.f</a>. Those cloud subroutines are very similar, and have many lines of common code. We modified the <a class="el" href="radiation__clouds_8f_source.html">radiation_clouds.f</a> module, and includes all the calculations of the cloud properties to a new subroutine radiation_clouds_prop. We also moved the common code from subroutines progcld to this new subroutine. Subroutine radiation_clouds_prop can be called by RRTMG and RRTMGP. A single call to the subroutine radiation_clouds_prop can connect to the calculations of the cloud radiation properties for all the microphysics schemes.</p>
<p>Summary of the major changes:</p><ul>
<li><a class="el" href="radiation__clouds_8f_source.html">radiation_clouds.f</a> : A new subroutine <a class="el" href="group__module__radiation__clouds_gade0c4ffb0276ff706253a39568a88a67.html#gade0c4ffb0276ff706253a39568a88a67" title="Subroutine radiation_clouds_prop computes cloud related quantities for different cloud microphysics s...">module_radiation_clouds::radiation_clouds_prop</a> was added to <a class="el" href="radiation__clouds_8f_source.html">radiation_clouds.f</a>. This new subroutine calculates all cloud radiation properties for all the microphysics schemes.<ul>
<li><a class="el" href="group__module__radiation__clouds_gac51e562082d901e15a3fb3a4dc7c7aad.html#gac51e562082d901e15a3fb3a4dc7c7aad" title="This subroutine computes cloud related quantities using zhao/moorthi&#39;s prognostic cloud microphysics ...">module_radiation_clouds::progcld_zhao_carr()</a></li>
<li><a class="el" href="group__module__radiation__clouds_ga65efc917e61be764d81f3b550111f8fb.html#ga65efc917e61be764d81f3b550111f8fb" title="This subroutine computes cloud related quantities using zhao/moorthi&#39;s prognostic cloud microphysics ...">module_radiation_clouds::progcld_zhao_carr_pdf()</a></li>
<li><a class="el" href="group__module__radiation__clouds_ga71d94b4a5abebc762e0590cc632c1b85.html#ga71d94b4a5abebc762e0590cc632c1b85" title="This subroutine computes cloud related quantities using GFDL Lin MP prognostic cloud microphysics sch...">module_radiation_clouds::progcld_gfdl_lin()</a></li>
<li><a class="el" href="group__module__radiation__clouds_ga9f1d337794ba446156ed48d61fefb76d.html#ga9f1d337794ba446156ed48d61fefb76d" title="This subroutine computes cloud related quantities using Ferrier-Aligo cloud microphysics scheme.">module_radiation_clouds::progcld_fer_hires()</a></li>
<li><a class="el" href="group__module__radiation__clouds_ga21b5982de59b5f60a24abe33946f40d0.html#ga21b5982de59b5f60a24abe33946f40d0" title="This subroutine is used by Thompson/WSM6/NSSL cloud microphysics (EMC).">module_radiation_clouds::progcld_thompson_wsm6()</a></li>
<li><a class="el" href="group__module__radiation__clouds_gaca12447bedda24f61315dc19c5634997.html#gaca12447bedda24f61315dc19c5634997" title="This subroutine computes cloud related quantities using for unified cloud microphysics scheme.">module_radiation_clouds::progclduni()</a></li>
<li><a class="el" href="group__module__radiation__clouds_ga0f8f599f3b125b66e0784e053208ae8f.html#ga0f8f599f3b125b66e0784e053208ae8f" title="This subroutine added by G. Thompson specifically to account for explicit (microphysics-produced) clo...">module_radiation_clouds::progcld_thompson()</a></li>
</ul>
</li>
<li>gfs_rrtmg_pre_run() : Removed the “progcld” subroutine calls, and replaced them with a single subroutine call to <a class="el" href="group__module__radiation__clouds_gade0c4ffb0276ff706253a39568a88a67.html#gade0c4ffb0276ff706253a39568a88a67" title="Subroutine radiation_clouds_prop computes cloud related quantities for different cloud microphysics s...">module_radiation_clouds::radiation_clouds_prop</a>.</li>
<li><a class="el" href="namespacemodule__radiation__cloud__overlap.html" title="module_radiation_cloud_overlap">module_radiation_cloud_overlap</a> : Replaced subroutine “get_alpha_exp” with <a class="el" href="namespacemodule__radiation__cloud__overlap_a68f3ae3556c2ff73e0062c254264b7ca.html#a68f3ae3556c2ff73e0062c254264b7ca" title="This subroutine provides the alpha cloud overlap parameter for both RRTMG and RRTMGP.">module_radiation_cloud_overlap::get_alpha_exper()</a>. The new subroutine revises alpha for exponential random cloud overlap option. This new subroutine is used in programs GFS_rrtmgp_cloud_overlap_pre.F90 and GFS_rrtmgp_gfdlmp_pre.F90.</li>
<li>Subroutine <a class="el" href="group__module__radiation__clouds_ga60bbaf4450625fd7c91d1d2c750f37af.html#ga60bbaf4450625fd7c91d1d2c750f37af" title="This subroutine computes high, mid, low, total, and boundary cloud fractions and cloud top/bottom lay...">module_radiation_clouds::gethml()</a> has been modified. The subroutine computes low, mid, high, total and boundary clouds, and is used in GFS_cloud_diagnostics.F90.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="intraphysics_rrtmg"></a>
Intraphysics Communication</h1>
<ul>
<li><b>GFS_suite_interstitial_rad_reset:</b> arg_table_GFS_suite_interstitial_rad_reset_run</li>
<li><b>gfs_rrtmg_pre:</b> arg_table_GFS_rrtmg_pre_run</li>
<li><b>GFS_radiation_surface:</b> arg_table_GFS_radiation_surface_run</li>
<li><b><a class="el" href="namespacerad__sw__pre.html" title="This module gathers the sunlit points for the shortwave radiation schemes.">rad_sw_pre</a>:</b> <a class="el" href="namespacerad__sw__pre_adcb78b758681ad97d0c8757992a51400.html#arg_table_rad_sw_pre_run" title="Argument Table">Argument Table</a></li>
<li><b><a class="el" href="namespacerrtmg__sw.html" title="This module contains the CCPP-compliant NCEP&#39;s modifications of the rrtmg-sw radiation code from aer ...">rrtmg_sw</a>:</b> <a class="el" href="group__module__radsw__main.html#arg_table_rrtmg_sw_run" title="Argument Table">Argument Table</a></li>
<li><b><a class="el" href="namespacerrtmg__sw__post.html" title="This module contains RRTMG-SW scheme post.">rrtmg_sw_post</a>:</b> <a class="el" href="group__rrtmg__sw__post.html#arg_table_rrtmg_sw_post_run" title="Argument Table">Argument Table</a></li>
<li><b>rrtmg_lw_pre:</b> arg_table_rrtmg_lw_pre_run</li>
<li><b><a class="el" href="namespacerrtmg__lw.html" title="This module contains the CCPP-compliant NCEP&#39;s modifications of the rrtmg-lw radiation code from aer ...">rrtmg_lw</a>:</b> <a class="el" href="group__module__radlw__main.html#arg_table_rrtmg_lw_run" title="Argument Table">Argument Table</a></li>
<li><b><a class="el" href="namespacerrtmg__lw__post.html" title="This module contains code executed after RRTMG-LW scheme.">rrtmg_lw_post</a>:</b> <a class="el" href="group__rrtmg__lw__post_ga3ce62517f26e262a788b653c7fd49f94.html#arg_table_rrtmg_lw_post_run" title="Argument Table">Argument Table</a></li>
<li><b>GFS_radiation_post:</b> arg_table_GFS_radiation_post_run</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="gen_al_rrtmg"></a>
General Algorithm</h1>
<ul>
<li><a class="el" href="group__module__radlw__main.html#gen_lwrad" title="RRTMG Longwave Radiation Scheme General Algorithm">RRTMG Longwave Radiation Scheme General Algorithm</a></li>
<li><a class="el" href="group__module__radsw__main.html#gen_swrad" title="RRTMG Shortwave Radiation Scheme General Algorithm">RRTMG Shortwave Radiation Scheme General Algorithm</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
    toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
    toggleButton.title = "Toggle Light/Dark Mode"
    $(document).ready(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
    // every resize will remove the button, which is why it has to be added again:
    $(window).resize(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
  })
</script>
</body>
</html>
