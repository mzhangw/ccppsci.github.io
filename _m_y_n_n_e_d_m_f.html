<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="CCPP SciDoc" />
<meta property="og:image" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta property="og:description" content="CCPP Scientific Documentation" />
<meta property="og:url" content="https://github.com/ufs-community/ccpp-physics" />
<!-- END opengraph metadata -->
<title>CCPP SciDoc v7.0.0: MYNN-EDMF Boundary Layer and Shallow Cloud Scheme</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-ccpp.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/ufs-community/ccpp-physics" class="github-corner" title="View source on GitHub" target="_blank" rel="noopener noreferrer">
    <svg viewBox="0 0 250 250" width="60" height="60" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="dtc_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CCPP SciDoc v7.0.0
   &#160;<span id="projectnumber">v7.0.0</span>
   </div>
   <div id="projectbrief">Common Community Physics Package Developed at DTC</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('_m_y_n_n_e_d_m_f.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">MYNN-EDMF Boundary Layer and Shallow Cloud Scheme </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1 class="doxsection"><a class="anchor" id="mynnedmf_descrip"></a>
Description</h1>
<p>The Mellor-Yamada-Nakanishi-Niino (Nakanishi and Niino 2009 <a class="el" href="citelist.html#CITEREF_nakanishi_2009">[148]</a>) eddy diffusivity-mass flux (EDMF) scheme was implemented into CCPP to introduce an alternative turbulent kinetic energy (TKE)-based planetary boundary layer (PBL) scheme which could serve as a candidate PBL parameterization for future operational implementations of the Unified Forecast System. The MYNN-EDMF is currently employed in NOAA's operational Rapid Refresh (RAP; Benjamin et al.2016 <a class="el" href="citelist.html#CITEREF_benjamin_2016">[20]</a>) and High-Resolution Rapid Refresh (HRRR) forecast systems.</p>
<p>The original MYNN scheme was demonstrated to be an improvement over predecessor Mellor-Yamada-type PBL schemes (e.g., Mellor and Yamada 1974,1982 <a class="el" href="citelist.html#CITEREF_mellor_1974">[137]</a> <a class="el" href="citelist.html#CITEREF_mellor_1982">[138]</a>) when compared against large-eddy simulation (LES) of a convective PBL (Nakanishi and Niino 2004, 2009 <a class="el" href="citelist.html#CITEREF_nakanishi_2004">[146]</a> <a class="el" href="citelist.html#CITEREF_nakanishi_2009">[148]</a>), the prediction of advection fog (Nakanishi and Niino 2006 <a class="el" href="citelist.html#CITEREF_nakanishi_2006">[147]</a>), and for the representation of coastal barrier jets (Olson and Brown 2009 <a class="el" href="citelist.html#CITEREF_olson_and_brown_2009">[156]</a>). The MYNN scheme can be configured to function at level 2.5, 2.6 (current default) or 3.0 closure and includes a partial-condensation scheme (also known as a cloud PDF or a statistical-cloud scheme) to represent the effects of subgrid-scale(SGS) clouds on the buoyancy flux (Nakanishi and Niino 2004, 2006, and 2009 <a class="el" href="citelist.html#CITEREF_nakanishi_2004">[146]</a> <a class="el" href="citelist.html#CITEREF_nakanishi_2006">[147]</a> <a class="el" href="citelist.html#CITEREF_nakanishi_2009">[148]</a>). The closure constants for the original MYNN scheme were tuned to a database of LES as opposed to observational data.</p>
<p>The MYNN-EDMF scheme has been extensively developed to improve upon the forecast skill of the original MYNN, largely driven by requirements to improve forecast skill in support of the NOAA's National Weather Service (NWS), the Federal Aviation Administration (FAA) and users within the renewable-energy industry.Specifically, fundamental changes were made to the formulation of the mixing lengths and representation of subgrid-scale(SGS) clouds, but new components have also been added to improve the representation of non-local mixing, the turbulence interaction with clouds, and the coupling to other model components (i.e., radiation). A description of the changes to the MYNN scheme are available in Olson et al.(2019) <a class="el" href="citelist.html#CITEREF_https://doi.org/10.25923/n9wm-be49">[157]</a>.</p>
<h1 class="doxsection"><a class="anchor" id="intra_mynnpbl"></a>
Intraphysics Communication</h1>
<ul>
<li><a class="el" href="_s_g_s_c_l_o_u_d_page.html" title="Subgrid-scale Cloud Interstitial">Subgrid-scale Cloud Interstitial</a></li>
</ul>
<p>The SGS clouds produced by the MYNN-EDMF scheme are coupled to the longwave and shortwave radiation schemes if the namelist parameter <code class="param">icloud_bl</code> is set to 1. In this case, the SGS cloud fraction, <code class="param">CLDFRA_BL</code>, and the SGS cloud-mixing ratio, <code class="param">QC_BL</code>, are added to the microphysics arrays within the radiation driver (mynnrad_pre_run()). The following two steps are performed:</p>
<p>(1) Use either Xu and Randall (1996) <a class="el" href="citelist.html#CITEREF_xu_and_randall_1996">[202]</a> or Chaboureau and Bechtold (2005) <a class="el" href="citelist.html#CITEREF_chaboureau_2005">[30]</a> cloud fraction for the convection scheme subgrid clouds, chosen by the switch <code class="param">conv_cf_opt</code> = 0: CB2005, 1: XR1996. Note that the MYNN-EDMF PBL scheme subgrid clouds input into this scheme are already partitioned into qc and qi and already have assigned cloud fractions, but now qi is further partitioned into qi and qsnow.</p>
<p>(2) if the resolved-scale cloud liquid ( \(q_c\)) is less than \(10^{-6}kg kg^{-1}\) , and there exists a nonzero SGS cloud fraction, then the SGS components are added to their respective resolved-scale components by a temperature weighting, according to linear approximation of Hobbs et al.(1974) <a class="el" href="citelist.html#CITEREF_hobbs_1974">[93]</a> . Next the frozen species are crudely split into 50% ice and 50% snow below approximately 700 hPa. The percentage of snow decreases with altitude and tapers off at approximately 300 hPa:   </p><p class="formulaDsp">
\[ W_{snow}=min(0.5,max((P-30000,0.0)/140000.0)
\]
</p>
<p class="formulaDsp">
\[ W_{ice}=1.0-W_{snow}
\]
</p>
<p>Next the SGS cloud water, liquid, and snow are sorted as:</p>
<p>\(q_c\)=QC_BL*CLDFRA_BL</p>
<p>\(q_i\)=QI_BL* \(W_{ice}\)*CLDFRA_BL</p>
<p>\(q_s\)=QI_BL* \(W_{snow}\)*CLDFRA_BL</p>
<p>This allows using a single 3-D array for both SGS cloud water,ice and snow. The updated \(q_{c}\), \(q_{i}\), \(q_{s}\)and <code class="param">CLDFRA</code> are then used as input into the radiation schemes. After exiting the radiation schemes, the original values of \(q_c, q_i, q_s\) and <code class="param">CLDFRA</code> are restored, so the SGS clouds do not impact the resolved-scale moisture budget.</p>
<p>The MYNN-EDMF CCPP-compliant interface: <a class="el" href="group__gp__mynnedmf.html#arg_table_mynnedmf_wrapper_run" title="Argument Table">Argument Table</a></p>
<h1 class="doxsection"><a class="anchor" id="gen_mynnedmf_conv"></a>
General Algorithm</h1>
<div class="image">
<img src="MYNN-EDMF_call_order.png" alt="" width="600"/>
<div class="caption">
Figure 1.The order of subroutines within the MYNN-EDMF (Courtesy of J.B. Olson). The green rectangles within the main subroutine (mynn_bl_driver()) represent subroutine calls. The blue rectangles represent tasks coded within the main driver. A brief description is shown on the right </div></div>
<p><a class="el" href="group__gp__mynnedmf_ga727e10ec7e7a73d34a7f50dadbda2b83.html#gen_mynn_bl_driver" title="mynn_bl_driver General Algorithm">mynn_bl_driver General Algorithm</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
    toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
    toggleButton.title = "Toggle Light/Dark Mode"
    $(document).ready(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
    // every resize will remove the button, which is why it has to be added again:
    $(window).resize(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
  })
</script>
</body>
</html>
