<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="CCPP SciDoc" />
<meta property="og:image" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta property="og:description" content="CCPP Scientific Documentation" />
<meta property="og:url" content="https://github.com/ufs-community/ccpp-physics" />
<!-- END opengraph metadata -->
<title>CCPP SciDoc v7.0.0: NoahMP LSM Model</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-ccpp.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/ufs-community/ccpp-physics" class="github-corner" title="View source on GitHub" target="_blank" rel="noopener noreferrer">
    <svg viewBox="0 0 250 250" width="60" height="60" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="dtc_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CCPP SciDoc v7.0.0
   &#160;<span id="projectnumber">v7.0.0</span>
   </div>
   <div id="projectbrief">Common Community Physics Package Developed at DTC</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('group___noah_m_p___l_s_m.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">NoahMP LSM Model </div></div>
</div><!--header-->
<div class="contents">

<p>This is the NoahMP LSM driver module, with the functionality of preparing variables to run the NoahMP LSM subroutine <a class="el" href="group___noah_m_p___l_s_m_gab480f7969dad27ce9e00e559f82c464e.html#gab480f7969dad27ce9e00e559f82c464e">noahmp_sflx()</a>, calling NoahMP LSM and post-processing variables for return to the parent model suite including unit conversion, as well as diagnotics calculation.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-namespaces" class="groupheader"><a id="namespaces" name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:noahmp_5Fglacier_5Froutines" id="r_noahmp_5Fglacier_5Froutines"><td class="memItemLeft">module &#160;</td><td class="memItemRight"><a class="el" href="namespacenoahmp__glacier__routines.html">noahmp_glacier_routines</a></td></tr>
<tr class="memdesc:namespacenoahmp__glacier__routines"><td class="mdescLeft">&#160;</td><td class="mdescRight">This module contains NoahMP glacier routines. <br /></td></tr>
<tr class="memitem:noahmp_5Ftables" id="r_noahmp_5Ftables"><td class="memItemLeft">module &#160;</td><td class="memItemRight"><a class="el" href="namespacenoahmp__tables.html">noahmp_tables</a></td></tr>
<tr class="memdesc:namespacenoahmp__tables"><td class="mdescLeft">&#160;</td><td class="mdescRight">brief Data from MPTABLE.TBL, SOILPARM.TBL, GENPARM.TBL for NoahMP <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ga86c69e134a41160e0c6f06bfb3a654a6" id="r_ga86c69e134a41160e0c6f06bfb3a654a6"><td class="memItemLeft">subroutine, public&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga86c69e134a41160e0c6f06bfb3a654a6.html#ga86c69e134a41160e0c6f06bfb3a654a6">noahmp_glacier_routines::noahmp_glacier</a> ( iloc,jloc,cosz,nsnow,nsoil,dt, sfctmp,sfcprs,uu,vv,q2,soldn, prcp,lwdn,tbot,zlvl,ficeold,zsoil, thsfc_loc,prslkix,prsik1x,prslk1x, psfc,pblhx,iz0tlnd,itime, sigmaf1,garea1,psi_opt, ep_1,ep_2,epsm1,cp, qsnow,sneqvo,albold,cm,ch,isnow, sneqv,smc,zsnso,snowh,snice,snliq, tg,stc,sh2o,tauss,qsfc, fsa,fsr,fira,fsh,fgev,ssoil, trad,edir,runsrf,runsub,sag,<a class="el" href="group___noah_m_p___l_s_m_ga9d5adb20aca5b72a7e126136088e20d1.html#ga9d5adb20aca5b72a7e126136088e20d1">albedo</a>, qsnbot,ponding,ponding1,ponding2,t2m, q2e,z0h_total, ifdef ccpp</td></tr>
<tr class="memitem:ga17573a155ef5f06ca4f81e8a35b8f22e" id="r_ga17573a155ef5f06ca4f81e8a35b8f22e"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga17573a155ef5f06ca4f81e8a35b8f22e.html#ga17573a155ef5f06ca4f81e8a35b8f22e">noahmp_glacier_routines::atm_glacier</a> (ep_2, epsm1, sfcprs, sfctmp, q2, soldn, cosz, thair, qair, eair, rhoair, solad, solai, swdown)</td></tr>
<tr class="memdesc:ga17573a155ef5f06ca4f81e8a35b8f22e"><td class="mdescLeft">&#160;</td><td class="mdescRight">re-process atmospheric forcing  <br /></td></tr>
<tr class="memitem:ga93dd9aedd32004c8cf2c88c222073c6a" id="r_ga93dd9aedd32004c8cf2c88c222073c6a"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga93dd9aedd32004c8cf2c88c222073c6a.html#ga93dd9aedd32004c8cf2c88c222073c6a">noahmp_glacier_routines::energy_glacier</a> (nsnow,nsoil,isnow,dt,qsnow,rhoair, eair,sfcprs,qair,sfctmp,lwdn,uu, vv,solad,solai,cosz,zref, tbot,zbot,zsnso,dzsnso,sigmaf1,garea1, thsfc_loc,prslkix,prsik1x,prslk1x, psfc,pblhx,iz0tlnd,itime,psi_opt, ep_1, ep_2, epsm1, cp, tg,stc,snowh,sneqv,sneqvo,sh2o, smc,snice,snliq,albold,cm,ch, ifdef ccpp</td></tr>
<tr class="memdesc:ga93dd9aedd32004c8cf2c88c222073c6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute energy budget (momentum &amp; energy fluxes and phase changes).  <br /></td></tr>
<tr class="memitem:ga2282179d290ca1b1610198040782accb" id="r_ga2282179d290ca1b1610198040782accb"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga2282179d290ca1b1610198040782accb.html#ga2282179d290ca1b1610198040782accb">noahmp_glacier_routines::thermoprop_glacier</a> (nsoil, nsnow, isnow, dzsnso, dt, snowh, snice, snliq, df, hcpct, snicev, snliqv, epore, fact)</td></tr>
<tr class="memdesc:ga2282179d290ca1b1610198040782accb"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate thermal properties of soil, snow, lake, and frozen soil.  <br /></td></tr>
<tr class="memitem:ga87a53ef88356626801e6ff98ce939011" id="r_ga87a53ef88356626801e6ff98ce939011"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga87a53ef88356626801e6ff98ce939011.html#ga87a53ef88356626801e6ff98ce939011">noahmp_glacier_routines::csnow_glacier</a> (isnow, nsnow, nsoil, snice, snliq, dzsnso, tksno, cvsno, snicev, snliqv, epore)</td></tr>
<tr class="memdesc:ga87a53ef88356626801e6ff98ce939011"><td class="mdescLeft">&#160;</td><td class="mdescRight"><br  />
 snow bulk density, volumetric capacity, and thermal conductivity  <br /></td></tr>
<tr class="memitem:ga7ad0f73530d119a7f827a4aaa8a9b393" id="r_ga7ad0f73530d119a7f827a4aaa8a9b393"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga7ad0f73530d119a7f827a4aaa8a9b393.html#ga7ad0f73530d119a7f827a4aaa8a9b393">noahmp_glacier_routines::radiation_glacier</a> (dt, tg, sneqvo, sneqv, cosz, qsnow, solad, solai, albold, tauss, sag, fsr, fsa, albsnd, albsni)</td></tr>
<tr class="memdesc:ga7ad0f73530d119a7f827a4aaa8a9b393"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute solar radiation: absorbed &amp; reflected by the ground.  <br /></td></tr>
<tr class="memitem:gac231e8b379ab2704f527cafe9a6a92f4" id="r_gac231e8b379ab2704f527cafe9a6a92f4"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gac231e8b379ab2704f527cafe9a6a92f4.html#gac231e8b379ab2704f527cafe9a6a92f4">noahmp_glacier_routines::snow_age_glacier</a> (dt, tg, sneqvo, sneqv, tauss, fage)</td></tr>
<tr class="memitem:ga613d1d7c1ed2ae1eef0bef9a893801be" id="r_ga613d1d7c1ed2ae1eef0bef9a893801be"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga613d1d7c1ed2ae1eef0bef9a893801be.html#ga613d1d7c1ed2ae1eef0bef9a893801be">noahmp_glacier_routines::snowalb_bats_glacier</a> (nband, cosz, fage, albsnd, albsni)</td></tr>
<tr class="memitem:gabfb2c60fe82d420428209f17e65ddf02" id="r_gabfb2c60fe82d420428209f17e65ddf02"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gabfb2c60fe82d420428209f17e65ddf02.html#gabfb2c60fe82d420428209f17e65ddf02">noahmp_glacier_routines::snowalb_class_glacier</a> (nband, qsnow, dt, alb, albold, albsnd, albsni)</td></tr>
<tr class="memitem:gaf512c10513f75c077220936b2ca74c42" id="r_gaf512c10513f75c077220936b2ca74c42"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gaf512c10513f75c077220936b2ca74c42.html#gaf512c10513f75c077220936b2ca74c42">noahmp_glacier_routines::glacier_flux</a> (nsoil,nsnow,emg,isnow,df,dzsnso,z0m, zlvl,zpd,qair,sfctmp,rhoair,sfcprs, ur,gamma,rsurf,lwdn,rhsur,smc, eair,stc,sag,snowh,lathea,sh2o, thsfc_loc,prslkix,prsik1x,prslk1x, psfc,pblhx,iz0tlnd,itime,uu,vv, sigmaf1,garea1,psi_opt,ep_1, ep_2, epsm1, cp, ifdef ccpp</td></tr>
<tr class="memdesc:gaf512c10513f75c077220936b2ca74c42"><td class="mdescLeft">&#160;</td><td class="mdescRight">use newton-raphson iteration to solve ground (tg) temperature that balances the surface energy budgets for glacier.  <br /></td></tr>
<tr class="memitem:ga198a78cba7dcb5d138ee9f2896b932ff" id="r_ga198a78cba7dcb5d138ee9f2896b932ff"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga198a78cba7dcb5d138ee9f2896b932ff.html#ga198a78cba7dcb5d138ee9f2896b932ff">noahmp_glacier_routines::esat</a> (t, esw, esi, desw, desi)</td></tr>
<tr class="memitem:ga3233db40fc83f01063964817c22944ac" id="r_ga3233db40fc83f01063964817c22944ac"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga3233db40fc83f01063964817c22944ac.html#ga3233db40fc83f01063964817c22944ac">noahmp_glacier_routines::sfcdif1_glacier</a> (iter,zlvl,zpd,z0h,z0m, qair,sfctmp,h,rhoair,mpe,ur, ifdef ccpp</td></tr>
<tr class="memdesc:ga3233db40fc83f01063964817c22944ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">compute surface drag coefficient cm for momentum and ch for heat  <br /></td></tr>
<tr class="memitem:ga476f265b4772bd2ad7825e02a29e32cd" id="r_ga476f265b4772bd2ad7825e02a29e32cd"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga476f265b4772bd2ad7825e02a29e32cd.html#ga476f265b4772bd2ad7825e02a29e32cd">noahmp_glacier_routines::tsnosoi_glacier</a> (nsoil, nsnow, isnow, dt, tbot, ssoil, snowh, zbot, zsnso, df, hcpct, stc)</td></tr>
<tr class="memitem:ga3d809b60b84d8ec6f0641d32edac467f" id="r_ga3d809b60b84d8ec6f0641d32edac467f"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga3d809b60b84d8ec6f0641d32edac467f.html#ga3d809b60b84d8ec6f0641d32edac467f">noahmp_glacier_routines::hrt_glacier</a> (nsnow, nsoil, isnow, zsnso, stc, tbot, zbot, df, hcpct, ssoil, phi, ai, bi, ci, rhsts, botflx)</td></tr>
<tr class="memitem:gad0ad01a8e6079c118f406348fc829ba8" id="r_gad0ad01a8e6079c118f406348fc829ba8"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gad0ad01a8e6079c118f406348fc829ba8.html#gad0ad01a8e6079c118f406348fc829ba8">noahmp_glacier_routines::hstep_glacier</a> (nsnow, nsoil, isnow, dt, ai, bi, ci, rhsts, stc)</td></tr>
<tr class="memitem:ga368ca6e0c1bef7000a6325c1c382421b" id="r_ga368ca6e0c1bef7000a6325c1c382421b"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga368ca6e0c1bef7000a6325c1c382421b.html#ga368ca6e0c1bef7000a6325c1c382421b">noahmp_glacier_routines::rosr12_glacier</a> (p, a, b, c, d, delta, ntop, nsoil, nsnow)</td></tr>
<tr class="memitem:ga827b1816e6e9afd09680b5d7fa3b010e" id="r_ga827b1816e6e9afd09680b5d7fa3b010e"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga827b1816e6e9afd09680b5d7fa3b010e.html#ga827b1816e6e9afd09680b5d7fa3b010e">noahmp_glacier_routines::phasechange_glacier</a> (nsnow, nsoil, isnow, dt, fact, dzsnso, stc, snice, snliq, sneqv, snowh, smc, sh2o, qmelt, imelt, ponding)</td></tr>
<tr class="memitem:ga7f8fc6fe269c4c0666edaf50859bfbce" id="r_ga7f8fc6fe269c4c0666edaf50859bfbce"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga7f8fc6fe269c4c0666edaf50859bfbce.html#ga7f8fc6fe269c4c0666edaf50859bfbce">noahmp_glacier_routines::water_glacier</a> (nsnow, nsoil, imelt, dt, prcp, sfctmp, qvap, qdew, ficeold, zsoil, isnow, snowh, sneqv, snice, snliq, stc, dzsnso, sh2o, sice, ponding, zsnso, fsh, runsrf, runsub, qsnow, ponding1, ponding2, qsnbot, fpice, esnow)</td></tr>
<tr class="memitem:ga7e56aa2916d87208019c88446904b04b" id="r_ga7e56aa2916d87208019c88446904b04b"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga7e56aa2916d87208019c88446904b04b.html#ga7e56aa2916d87208019c88446904b04b">noahmp_glacier_routines::snowwater_glacier</a> (nsnow, nsoil, imelt, dt, sfctmp, snowhin, qsnow, qsnfro, qsnsub, qrain, ficeold, zsoil, isnow, snowh, sneqv, snice, snliq, sh2o, sice, stc, dzsnso, zsnso, fsh, qsnbot, snoflow, ponding1, ponding2)</td></tr>
<tr class="memitem:ga8017d043aecaf401ec7e591c3c558161" id="r_ga8017d043aecaf401ec7e591c3c558161"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga8017d043aecaf401ec7e591c3c558161.html#ga8017d043aecaf401ec7e591c3c558161">noahmp_glacier_routines::snowfall_glacier</a> (nsoil, nsnow, dt, qsnow, snowhin, sfctmp, isnow, snowh, dzsnso, stc, snice, snliq, sneqv)</td></tr>
<tr class="memitem:ga5c2db6763c56bf372eef6bdc07ede3cc" id="r_ga5c2db6763c56bf372eef6bdc07ede3cc"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga5c2db6763c56bf372eef6bdc07ede3cc.html#ga5c2db6763c56bf372eef6bdc07ede3cc">noahmp_glacier_routines::compact_glacier</a> (nsnow, nsoil, dt, stc, snice, snliq, imelt, ficeold, isnow, dzsnso)</td></tr>
<tr class="memitem:ga70ce0369bd8ba21d6ab56fa001a20be8" id="r_ga70ce0369bd8ba21d6ab56fa001a20be8"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga70ce0369bd8ba21d6ab56fa001a20be8.html#ga70ce0369bd8ba21d6ab56fa001a20be8">noahmp_glacier_routines::combine_glacier</a> (nsnow, nsoil, isnow, sh2o, stc, snice, snliq, dzsnso, sice, snowh, sneqv, ponding1, ponding2)</td></tr>
<tr class="memitem:ga2725fe77ae7f78845a85c7c379e3ed2e" id="r_ga2725fe77ae7f78845a85c7c379e3ed2e"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga2725fe77ae7f78845a85c7c379e3ed2e.html#ga2725fe77ae7f78845a85c7c379e3ed2e">noahmp_glacier_routines::combo_glacier</a> (dz, wliq, wice, t, dz2, wliq2, wice2, t2)</td></tr>
<tr class="memitem:ga7d14a54053fc9c70ea7705754d594a92" id="r_ga7d14a54053fc9c70ea7705754d594a92"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga7d14a54053fc9c70ea7705754d594a92.html#ga7d14a54053fc9c70ea7705754d594a92">noahmp_glacier_routines::divide_glacier</a> (nsnow, nsoil, isnow, stc, snice, snliq, dzsnso)</td></tr>
<tr class="memitem:ga3b426a088b2f2e94145bc4cea265cc61" id="r_ga3b426a088b2f2e94145bc4cea265cc61"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga3b426a088b2f2e94145bc4cea265cc61.html#ga3b426a088b2f2e94145bc4cea265cc61">noahmp_glacier_routines::snowh2o_glacier</a> (nsnow, nsoil, dt, qsnfro, qsnsub, qrain, isnow, dzsnso, snowh, sneqv, snice, snliq, sh2o, sice, stc, ponding1, ponding2, fsh, qsnbot)</td></tr>
<tr class="memitem:ga66e01db7fffd36858b38bc8a61de48db" id="r_ga66e01db7fffd36858b38bc8a61de48db"><td class="memItemLeft">subroutine, private&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga66e01db7fffd36858b38bc8a61de48db.html#ga66e01db7fffd36858b38bc8a61de48db">noahmp_glacier_routines::error_glacier</a> (iloc,jloc,swdown,fsa,fsr,fira, fsh,fgev,ssoil,sag,prcp,edir, ifdef ccpp</td></tr>
<tr class="memitem:gaf81644009a5fffc426875308d6f3f609" id="r_gaf81644009a5fffc426875308d6f3f609"><td class="memItemLeft">subroutine, public&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gaf81644009a5fffc426875308d6f3f609.html#gaf81644009a5fffc426875308d6f3f609">noahmp_glacier_routines::noahmp_options_glacier</a> (iopt_alb, iopt_snf, iopt_tbot, iopt_stc, iopt_gla, iopt_sfc, iopt_trs)</td></tr>
<tr class="memitem:gab480f7969dad27ce9e00e559f82c464e" id="r_gab480f7969dad27ce9e00e559f82c464e"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gab480f7969dad27ce9e00e559f82c464e.html#gab480f7969dad27ce9e00e559f82c464e">noahmp_sflx</a> (parameters, iloc, jloc, lat, yearlen, julian, cosz, dt, dx, dz8w, nsoil, zsoil, nsnow, shdfac, shdmax, vegtyp, ice, ist, croptype, smceq, sfctmp, sfcprs, psfc, uu, vv, q2, garea1, qc, soldn, lwdn, thsfc_loc, prslkix, prsik1x, prslk1x, pblhx, iz0tlnd, itime,psi_opt, prcpconv, prcpnonc, prcpshcv, prcpsnow, prcpgrpl, prcphail, tbot, co2air, o2air, foln, ficeold, zlvl, ep_1, ep_2, epsm1, cp, albold, sneqvo, stc, sh2o, smc, tah, eah, fwet, canliq, canice, tv, tg, qsfc, qsnow, qrain, isnow, zsnso, snowh, sneqv, snice, snliq, zwt, wa, wt, wslake, lfmass, rtmass, stmass, wood, stblcp, fastcp, lai, sai, cm, ch, tauss, grain, gdd, pgs, smcwtd,deeprech, rech, ustarx, z0wrf, z0hwrf, ts, fsa, fsr, fira, fsh, ssoil, fcev, fgev, fctr, ecan, etran, edir, trad, tgb, tgv, t2mv, t2mb, q2v, q2b, runsrf, runsub, apar, psn, sav, sag, fsno, nee, gpp, npp, fveg, <a class="el" href="group___noah_m_p___l_s_m_ga9d5adb20aca5b72a7e126136088e20d1.html#ga9d5adb20aca5b72a7e126136088e20d1">albedo</a>, qsnbot, ponding, ponding1, ponding2, rssun, rssha, albd, albi, albsnd, albsni, bgap, wgap, chv, chb, emissi, shg, shc, shb, evg, evb, ghv, ghb, irg, irc, irb, tr, evc, chleaf, chuc, chv2, chb2, fpice, pahv, pahg, pahb, pah, esnow, canhs, laisun, laisha, rb, qsfcveg, qsfcbare ifdef ccpp</td></tr>
<tr class="memitem:gaaa1c80676aa99115b5018274a4118bea" id="r_gaaa1c80676aa99115b5018274a4118bea"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gaaa1c80676aa99115b5018274a4118bea.html#gaaa1c80676aa99115b5018274a4118bea">atm</a> (parameters, ep_2, epsm1, sfcprs, sfctmp, q2, prcpconv, prcpnonc, prcpshcv, prcpsnow, prcpgrpl, prcphail, soldn, cosz, thair, qair, eair, rhoair, qprecc, qprecl, solad, solai, swdown, bdfall, rain, snow, fp, fpice, prcp)</td></tr>
<tr class="memdesc:gaaa1c80676aa99115b5018274a4118bea"><td class="mdescLeft">&#160;</td><td class="mdescRight">re-precess atmospheric forcing.  <br /></td></tr>
<tr class="memitem:ga5e34b57807b60c6097c5ed0ceedb9e9d" id="r_ga5e34b57807b60c6097c5ed0ceedb9e9d"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga5e34b57807b60c6097c5ed0ceedb9e9d.html#ga5e34b57807b60c6097c5ed0ceedb9e9d">phenology</a> (parameters, vegtyp, croptype, snowh, tv, lat, yearlen, julian, lai, sai, troot, elai, esai, igs, pgs)</td></tr>
<tr class="memdesc:ga5e34b57807b60c6097c5ed0ceedb9e9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">vegetation phenology considering vegetation canopy being buried by snow and evolution in time.  <br /></td></tr>
<tr class="memitem:gad7b91b874e0aaa6593ad25a2a4fee78b" id="r_gad7b91b874e0aaa6593ad25a2a4fee78b"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gad7b91b874e0aaa6593ad25a2a4fee78b.html#gad7b91b874e0aaa6593ad25a2a4fee78b">precip_heat</a> (parameters, iloc, jloc, vegtyp, dt, uu, vv, elai, esai, fveg, ist, bdfall, rain, snow, fp, canliq, canice, tv, sfctmp, tg, qintr, qdripr, qthror, qints, qdrips, qthros, pahv, pahg, pahb, qrain, qsnow, snowhin, fwet, cmc)</td></tr>
<tr class="memdesc:gad7b91b874e0aaa6593ad25a2a4fee78b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Michael Barlage: Oct 2013 - Split canwater to calculate precip movement for tracking of advected heat.  <br /></td></tr>
<tr class="memitem:gace27cd3a7b4e23955e39e33bd344baae" id="r_gace27cd3a7b4e23955e39e33bd344baae"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gace27cd3a7b4e23955e39e33bd344baae.html#gace27cd3a7b4e23955e39e33bd344baae">error</a> (parameters, swdown,fsa,fsr,fira,fsh,fcev, fgev,fctr,ssoil,beg_wb,canliq,canice, sneqv,wa,smc,dzsnso,prcp,ecan, etran,edir,runsrf,runsub,dt,nsoil, nsnow,ist,errwat, iloc,jloc,fveg, sav,sag,fsrv,fsrg,zwt,pah, ifdef ccpp</td></tr>
<tr class="memdesc:gace27cd3a7b4e23955e39e33bd344baae"><td class="mdescLeft">&#160;</td><td class="mdescRight">check surface energy balance and water balance.  <br /></td></tr>
<tr class="memitem:ga2698d46b5582d11d0d6fc78d49dd796c" id="r_ga2698d46b5582d11d0d6fc78d49dd796c"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga2698d46b5582d11d0d6fc78d49dd796c.html#ga2698d46b5582d11d0d6fc78d49dd796c">energy</a> (parameters, ice,vegtyp,ist,nsnow,nsoil, isnow,dt,rhoair,sfcprs,qair, sfctmp,thair,lwdn,uu,vv,zref, co2air,o2air,solad,solai,cosz,igs, eair,tbot,zsnso,zsoil, elai,esai,fwet,foln, fveg,shdfac, pahv,pahg,pahb, qsnow,dzsnso,lat,canliq,canice,iloc, jloc, thsfc_loc, prslkix, prsik1x, prslk1x, garea1, pblhx, iz0tlnd, itime, psi_opt, ep_1, ep_2, epsm1, cp, z0wrf,z0hwrf, imelt,snicev,snliqv,epore,t2m,fsno, sav,sag,qmelt,fsa,fsr,taux, tauy,fira,fsh,fcev,fgev,fctr, trad,psn,apar,ssoil,btrani,btran, ponding, ts,latheav, latheag, frozen_canopy, frozen_ground, tv,tg,stc,snowh,eah,tah, sneqvo,sneqv,sh2o,smc,snice,snliq, albold,cm,ch,dx,dz8w,q2, ustarx, ifdef ccpp</td></tr>
<tr class="memdesc:ga2698d46b5582d11d0d6fc78d49dd796c"><td class="mdescLeft">&#160;</td><td class="mdescRight">We use different approaches to deal with subgrid features of radiation transfer and turbulent transfer. we use 'tile' approach to compute turbulent fluxes,while we use modified two-stream to compute radiation transfer. tile approach, assemblying vegetation canopies together, <br  />
 may expose too much ground surfaces (either covered by snow or grass) to solar radiation. the modified two-stream assumes vegetation covers fully the gridcell but with gaps between tree crowns.  <br /></td></tr>
<tr class="memitem:gaad69cb985ab68c251907ca0480ee917f" id="r_gaad69cb985ab68c251907ca0480ee917f"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gaad69cb985ab68c251907ca0480ee917f.html#gaad69cb985ab68c251907ca0480ee917f">thermoprop</a> (parameters, nsoil, nsnow, isnow, ist, dzsnso, dt, snowh, snice, snliq, shdfac, smc, sh2o, tg, stc, ur, lat, z0m, zlvl, vegtyp, df, hcpct, snicev, snliqv, epore, fact)</td></tr>
<tr class="memitem:gaa026774816274ad1b9a02c5d0826aaea" id="r_gaa026774816274ad1b9a02c5d0826aaea"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gaa026774816274ad1b9a02c5d0826aaea.html#gaa026774816274ad1b9a02c5d0826aaea">csnow</a> (parameters, isnow, nsnow, nsoil, snice, snliq, dzsnso, tksno, cvsno, snicev, snliqv, epore)</td></tr>
<tr class="memdesc:gaa026774816274ad1b9a02c5d0826aaea"><td class="mdescLeft">&#160;</td><td class="mdescRight">snow bulk density,volumetric capacity, and thermal conductivity  <br /></td></tr>
<tr class="memitem:ga97cc7d00fd0fbc9628decbee58dcd8a9" id="r_ga97cc7d00fd0fbc9628decbee58dcd8a9"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga97cc7d00fd0fbc9628decbee58dcd8a9.html#ga97cc7d00fd0fbc9628decbee58dcd8a9">tdfcnd</a> (parameters, isoil, df, smc, sh2o)</td></tr>
<tr class="memdesc:ga97cc7d00fd0fbc9628decbee58dcd8a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate thermal diffusivity and conductivity of the soil. peters-lidard approach (peters-lidard et al., 1998)  <br /></td></tr>
<tr class="memitem:gaaa3073947247829ad606eea763d888f8" id="r_gaaa3073947247829ad606eea763d888f8"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gaaa3073947247829ad606eea763d888f8.html#gaaa3073947247829ad606eea763d888f8">radiation</a> (parameters, vegtyp, ist, ice, nsoil, sneqvo, sneqv, dt, cosz, snowh, tg, tv, fsno, qsnow, fwet, elai, esai, smc, solad, solai, fveg, iloc, jloc, albold, tauss, fsun, laisun, laisha, parsun, parsha, sav, sag, fsr, fsa, fsrv, fsrg, albd, albi, albsnd, albsni, bgap, wgap)</td></tr>
<tr class="memdesc:gaaa3073947247829ad606eea763d888f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate solar radiation: absorbed &amp; reflected by the ground and canopy.  <br /></td></tr>
<tr class="memitem:ga9d5adb20aca5b72a7e126136088e20d1" id="r_ga9d5adb20aca5b72a7e126136088e20d1"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga9d5adb20aca5b72a7e126136088e20d1.html#ga9d5adb20aca5b72a7e126136088e20d1">albedo</a> (parameters, vegtyp, ist, ice, nsoil, dt, cosz, fage, elai, esai, tg, tv, snowh, fsno, fwet, smc, sneqvo, sneqv, qsnow, fveg, iloc, jloc, albold, tauss, albgrd, albgri, albd, albi, fabd, fabi, ftdd, ftid, ftii, fsun, frevi, frevd, fregd, fregi, bgap, wgap, albsnd, albsni)</td></tr>
<tr class="memdesc:ga9d5adb20aca5b72a7e126136088e20d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">surface albedos. also fluxes (per unit incoming direct and diffuse radiation) reflected, transmitted, and absorbed by vegetation. also sunlight fraction of the canopy.  <br /></td></tr>
<tr class="memitem:ga04d44126dfc46d383150a1525f46dbcc" id="r_ga04d44126dfc46d383150a1525f46dbcc"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga04d44126dfc46d383150a1525f46dbcc.html#ga04d44126dfc46d383150a1525f46dbcc">surrad</a> (parameters, mpe, fsun, fsha, elai, vai, laisun, laisha, solad, solai, fabd, fabi, ftdd, ftid, ftii, albgrd, albgri, albd, albi, iloc, jloc, parsun, parsha, sav, sag, fsa, fsr, frevi, frevd, fregd, fregi, fsrv, fsrg)</td></tr>
<tr class="memdesc:ga04d44126dfc46d383150a1525f46dbcc"><td class="mdescLeft">&#160;</td><td class="mdescRight">surface raditiation  <br /></td></tr>
<tr class="memitem:ga748c587c5dc0a38a1793042e92952d43" id="r_ga748c587c5dc0a38a1793042e92952d43"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga748c587c5dc0a38a1793042e92952d43.html#ga748c587c5dc0a38a1793042e92952d43">snow_age</a> (parameters, dt, tg, sneqvo, sneqv, tauss, fage)</td></tr>
<tr class="memitem:ga238debe3053962b0b33a5e846e333701" id="r_ga238debe3053962b0b33a5e846e333701"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga238debe3053962b0b33a5e846e333701.html#ga238debe3053962b0b33a5e846e333701">snowalb_bats</a> (parameters, nband, fsno, cosz, fage, albsnd, albsni)</td></tr>
<tr class="memdesc:ga238debe3053962b0b33a5e846e333701"><td class="mdescLeft">&#160;</td><td class="mdescRight">bats snow surface albedo  <br /></td></tr>
<tr class="memitem:ga2ea2346edd6f426f30dcc99085def5cf" id="r_ga2ea2346edd6f426f30dcc99085def5cf"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga2ea2346edd6f426f30dcc99085def5cf.html#ga2ea2346edd6f426f30dcc99085def5cf">snowalb_class</a> (parameters, nband, qsnow, dt, alb, albold, albsnd, albsni, iloc, jloc)</td></tr>
<tr class="memdesc:ga2ea2346edd6f426f30dcc99085def5cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">class snow surface albedo  <br /></td></tr>
<tr class="memitem:ga497b40d27709666f17da3e555f8628a1" id="r_ga497b40d27709666f17da3e555f8628a1"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga497b40d27709666f17da3e555f8628a1.html#ga497b40d27709666f17da3e555f8628a1">groundalb</a> (parameters, nsoil, nband, ice, ist, fsno, smc, albsnd, albsni, cosz, tg, iloc, jloc, albgrd, albgri)</td></tr>
<tr class="memdesc:ga497b40d27709666f17da3e555f8628a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">ground surface albedo  <br /></td></tr>
<tr class="memitem:gaa737a61978bde4dc6363e11263999769" id="r_gaa737a61978bde4dc6363e11263999769"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gaa737a61978bde4dc6363e11263999769.html#gaa737a61978bde4dc6363e11263999769">twostream</a> (parameters, ib, ic, vegtyp, cosz, vai, fwet, t, albgrd, albgri, rho, tau, fveg, ist, iloc, jloc, fab, fre, ftd, fti, gdir, frev, freg, bgap, wgap)</td></tr>
<tr class="memdesc:gaa737a61978bde4dc6363e11263999769"><td class="mdescLeft">&#160;</td><td class="mdescRight">use two-stream approximation of Dickinson (1983) adv geophysics 25: 305-353 and sellers (1985) int j remote sensing 6: 1335-1372 to calculate fluxes absorbed by vegetation, reflected by vegetation, and transmitted through vegetation for unit incoming direct or diffuse flux given an underlying surface with known albedo.  <br /></td></tr>
<tr class="memitem:gadf2b2287685bf9c610afdb949c1c6cdb" id="r_gadf2b2287685bf9c610afdb949c1c6cdb"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gadf2b2287685bf9c610afdb949c1c6cdb.html#gadf2b2287685bf9c610afdb949c1c6cdb">vege_flux</a> (parameters, nsnow,nsoil,isnow,vegtyp,veg, dt,sav,sag,lwdn,ur, uu,vv,sfctmp,thair,qair, eair,rhoair,snowh,vai,gammav,gammag, fwet,laisun,laisha,cwp,dzsnso, zlvl,zpd,z0m,fveg,shdfac, z0mg,emv,emg,canliq,fsno, canice,stc,df,rssun,rssha, rsurf,latheav,latheag,parsun,parsha,igs, foln,co2air,o2air,btran,sfcprs, rhsur,iloc,jloc,q2,pahv,pahg, thsfc_loc, prslkix, prsik1x, prslk1x, garea1, pblhx,iz0tlnd,itime,psi_opt,ep_1, ep_2, epsm1, cp, eah,tah,tv,tg,cm, ustarx, ifdef ccpp</td></tr>
<tr class="memdesc:gadf2b2287685bf9c610afdb949c1c6cdb"><td class="mdescLeft">&#160;</td><td class="mdescRight">use newton-raphson iteration to solve for vegetation (tv) and ground (tg) temperatures that balance the surface energy budgets.  <br /></td></tr>
<tr class="memitem:gaeb5a9f0cae890fa73e0e17f9b4be30c2" id="r_gaeb5a9f0cae890fa73e0e17f9b4be30c2"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gaeb5a9f0cae890fa73e0e17f9b4be30c2.html#gaeb5a9f0cae890fa73e0e17f9b4be30c2">bare_flux</a> (parameters, nsnow,nsoil,isnow,dt,sag, lwdn,ur,uu,vv,sfctmp, thair,qair,eair,rhoair,snowh, dzsnso,zlvl,zpd,z0m,fsno, emg,stc,df,rsurf,lathea, gamma,rhsur,iloc,jloc,q2,pahb, thsfc_loc, prslkix, prsik1x, prslk1x, vegtyp, fveg, shdfac, garea1, pblhx, iz0tlnd, itime,psi_opt, ep_1, ep_2, epsm1, cp,ifdef ccpp</td></tr>
<tr class="memdesc:gaeb5a9f0cae890fa73e0e17f9b4be30c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">use newton-raphson iteration to solve ground (tg) temperature that balances the surface energy budgets for bare soil fraction.  <br /></td></tr>
<tr class="memitem:gacbfc8b3400751a5ca499cdb11faf7444" id="r_gacbfc8b3400751a5ca499cdb11faf7444"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gacbfc8b3400751a5ca499cdb11faf7444.html#gacbfc8b3400751a5ca499cdb11faf7444">ragrb</a> (parameters, iter, vai, rhoair, hg, tah, zpd, z0mg, z0hg, hcan, uc, z0h, fv, cwp, vegtyp, mpe, tv, mozg, fhg, fhgh, iloc, jloc, ramg, rahg, rawg, rb)</td></tr>
<tr class="memdesc:gacbfc8b3400751a5ca499cdb11faf7444"><td class="mdescLeft">&#160;</td><td class="mdescRight">compute under-canopy aerodynamic resistance rag and leaf boundary layer resistance rb.  <br /></td></tr>
<tr class="memitem:ga4e76a9ee20e3ff7f36f761ffdc781690" id="r_ga4e76a9ee20e3ff7f36f761ffdc781690"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga4e76a9ee20e3ff7f36f761ffdc781690.html#ga4e76a9ee20e3ff7f36f761ffdc781690">sfcdif1</a> (parameters, iter,sfctmp,rhoair,h,qair, zlvl,zpd,z0m,z0h,ur, mpe,iloc,jloc, ifdef ccpp</td></tr>
<tr class="memdesc:ga4e76a9ee20e3ff7f36f761ffdc781690"><td class="mdescLeft">&#160;</td><td class="mdescRight">compute surface drag coefficient cm for momentum and ch for heat.  <br /></td></tr>
<tr class="memitem:ga8a86a91a2b7884f8fcd1d32a0edc405e" id="r_ga8a86a91a2b7884f8fcd1d32a0edc405e"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga8a86a91a2b7884f8fcd1d32a0edc405e.html#ga8a86a91a2b7884f8fcd1d32a0edc405e">sfcdif2</a> (parameters, iter, z0, thz0, thlm, sfcspd, zlm, iloc, jloc, akms, akhs, rlmo, wstar2, ustar)</td></tr>
<tr class="memdesc:ga8a86a91a2b7884f8fcd1d32a0edc405e"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate surface layer exchange coefficients via iteractive process (Chen et al. 1997, blm)  <br /></td></tr>
<tr class="memitem:ga5894e4162657666340f3bd83f4b6263d" id="r_ga5894e4162657666340f3bd83f4b6263d"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga5894e4162657666340f3bd83f4b6263d.html#ga5894e4162657666340f3bd83f4b6263d">sfcdif3</a> (parameters, iloc, jloc, iter, sfctmp, qair, ur, zlvl, tgb, thsfc_loc, prslkix, prsik1x, prslk1x, z0m, z0h, zpd, snowh, fveg, garea1, ustarx, fm, fh, fm2, fh2, fv, cm, ch)</td></tr>
<tr class="memdesc:ga5894e4162657666340f3bd83f4b6263d"><td class="mdescLeft">&#160;</td><td class="mdescRight">compute surface drag coefficient cm for momentum and ch for heat.  <br /></td></tr>
<tr class="memitem:gae2fa81a8d36349faf818400ee46c6357" id="r_gae2fa81a8d36349faf818400ee46c6357"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gae2fa81a8d36349faf818400ee46c6357.html#gae2fa81a8d36349faf818400ee46c6357">thermalz0</a> (parameters, fveg, z0m, z0mg, zlvl, zpd, ezpd, ustarx, vegtyp, vaie, ur, c_sigma_f0, c_sigma_f1, a1, cdmn_v, cdmn_g, surface_flag, z0m_out, z0h_out)</td></tr>
<tr class="memitem:gaecaebf370302a4553aafbf34e22f68c7" id="r_gaecaebf370302a4553aafbf34e22f68c7"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gaecaebf370302a4553aafbf34e22f68c7.html#gaecaebf370302a4553aafbf34e22f68c7">esat</a> (t, esw, esi, desw, desi)</td></tr>
<tr class="memdesc:gaecaebf370302a4553aafbf34e22f68c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">use polynomials to calculate saturation vapor pressure and derivative with respect to temperature: over water when t &gt; 0 c and over ice when t &lt;= 0 c.  <br /></td></tr>
<tr class="memitem:gaeb7ee3e6405cb5d9bbec7126ee2e7772" id="r_gaeb7ee3e6405cb5d9bbec7126ee2e7772"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gaeb7ee3e6405cb5d9bbec7126ee2e7772.html#gaeb7ee3e6405cb5d9bbec7126ee2e7772">stomata</a> (parameters, vegtyp, mpe, apar, foln, iloc, jloc, tv, ei, ea, sfctmp, sfcprs, o2, co2, igs, btran, rb, rs, psn)</td></tr>
<tr class="memitem:gaefd89a05ffdebdf90a566066a5704afb" id="r_gaefd89a05ffdebdf90a566066a5704afb"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gaefd89a05ffdebdf90a566066a5704afb.html#gaefd89a05ffdebdf90a566066a5704afb">canres</a> (parameters, ep_2, epsm1, par, sfctmp, rcsoil, eah, sfcprs, rc, psn, iloc, jloc)</td></tr>
<tr class="memdesc:gaefd89a05ffdebdf90a566066a5704afb"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate canopy resistance which depends on incoming solar radiation, air temperature, atmospheric water vapor pressure deficit at the lowest model level, and soil moisture (preferably unfrozen soil moisture rather than total).  <br /></td></tr>
<tr class="memitem:gaa0c1d53715638ac0451a47dd559b22ae" id="r_gaa0c1d53715638ac0451a47dd559b22ae"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gaa0c1d53715638ac0451a47dd559b22ae.html#gaa0c1d53715638ac0451a47dd559b22ae">calhum</a> (parameters, sfctmp, sfcprs, q2sat, dqsdt2)</td></tr>
<tr class="memitem:ga75765a418ab7cac83a29ee89bcc28da9" id="r_ga75765a418ab7cac83a29ee89bcc28da9"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga75765a418ab7cac83a29ee89bcc28da9.html#ga75765a418ab7cac83a29ee89bcc28da9">tsnosoi</a> (parameters, ice,nsoil,nsnow,isnow,ist, tbot,zsnso,ssoil,df,hcpct, sag,dt,snowh,dzsnso, tg,iloc,jloc, ifdef ccpp</td></tr>
<tr class="memdesc:ga75765a418ab7cac83a29ee89bcc28da9"><td class="mdescLeft">&#160;</td><td class="mdescRight">compute snow (up to 3l) and soil (4l) temperature. note that snow temperatures during melting season may exceed melting point (tfrz) but later in phasechange subroutine the snow temperatures are reset to tfrz for melting snow.  <br /></td></tr>
<tr class="memitem:ga676e00f810d3c10c628b878fd7d2c728" id="r_ga676e00f810d3c10c628b878fd7d2c728"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga676e00f810d3c10c628b878fd7d2c728.html#ga676e00f810d3c10c628b878fd7d2c728">hrt</a> (parameters, nsnow, nsoil, isnow, zsnso, stc, tbot, zbot, dt, df, hcpct, ssoil, phi, ai, bi, ci, rhsts, botflx)</td></tr>
<tr class="memdesc:ga676e00f810d3c10c628b878fd7d2c728"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate the right hand side of the time tendency term of the soil thermal diffusion equation. also to compute (prepare) the matrix coefficients for the tri-diagonal matrix of the implicit time scheme.  <br /></td></tr>
<tr class="memitem:ga1ee9e5d99d3e45d7647507959077328a" id="r_ga1ee9e5d99d3e45d7647507959077328a"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga1ee9e5d99d3e45d7647507959077328a.html#ga1ee9e5d99d3e45d7647507959077328a">hstep</a> (parameters, nsnow, nsoil, isnow, dt, ai, bi, ci, rhsts, stc)</td></tr>
<tr class="memdesc:ga1ee9e5d99d3e45d7647507959077328a"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate/update the soil temperature fields.  <br /></td></tr>
<tr class="memitem:ga7a305dbb6a9210b227ee310c71f30fd9" id="r_ga7a305dbb6a9210b227ee310c71f30fd9"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga7a305dbb6a9210b227ee310c71f30fd9.html#ga7a305dbb6a9210b227ee310c71f30fd9">rosr12</a> (p, a, b, c, d, delta, ntop, nsoil, nsnow)</td></tr>
<tr class="memdesc:ga7a305dbb6a9210b227ee310c71f30fd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">solve the tri-diagonal matrix equation  <br /></td></tr>
<tr class="memitem:ga224e81e192ae0cf37b2b8b52cd19ee82" id="r_ga224e81e192ae0cf37b2b8b52cd19ee82"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga224e81e192ae0cf37b2b8b52cd19ee82.html#ga224e81e192ae0cf37b2b8b52cd19ee82">phasechange</a> (parameters, nsnow,nsoil,isnow,dt,fact, dzsnso,hcpct,ist,iloc,jloc, stc,snice,snliq,sneqv,snowh, ifdef ccpp</td></tr>
<tr class="memdesc:ga224e81e192ae0cf37b2b8b52cd19ee82"><td class="mdescLeft">&#160;</td><td class="mdescRight">melting/freezing of snow water and soil water  <br /></td></tr>
<tr class="memitem:ga3828ee66b8dbae34856cd229066adeb8" id="r_ga3828ee66b8dbae34856cd229066adeb8"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga3828ee66b8dbae34856cd229066adeb8.html#ga3828ee66b8dbae34856cd229066adeb8">frh2o</a> (parameters, isoil, free, tkelv, smc, sh2o, ifdef ccpp</td></tr>
<tr class="memdesc:ga3828ee66b8dbae34856cd229066adeb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate amount of supercooled liquid soil water content if temperature is below 273.15k (tfrz). requires newton-type iteration to solve the nonlinear implicit equation given in eqn 17 of koren et al. (1999, jgr, vol 104(d16),19569-19585)  <br /></td></tr>
<tr class="memitem:ga2e84840f3ed90005f066340b388c03d6" id="r_ga2e84840f3ed90005f066340b388c03d6"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga2e84840f3ed90005f066340b388c03d6.html#ga2e84840f3ed90005f066340b388c03d6">water</a> (parameters, vegtyp, nsnow, nsoil, imelt, dt, uu, vv, fcev, fctr, qprecc, qprecl, elai, esai, sfctmp, qvap, qdew, zsoil, btrani, ficeold, ponding, tg, ist, fveg, iloc, jloc, smceq, bdfall, fp, rain, snow, qsnow, qrain, snowhin, latheav, latheag, frozen_canopy, frozen_ground, isnow, canliq, canice, tv, snowh, sneqv, snice, snliq, stc, zsnso, sh2o, smc, sice, zwt, wa, wt, dzsnso, wslake, smcwtd, deeprech, rech, cmc, ecan, etran, fwet, runsrf, runsub, qin, qdis, ponding1, ponding2, qsnbot, esnow)</td></tr>
<tr class="memdesc:ga2e84840f3ed90005f066340b388c03d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">compute water budgets (water storages, et components, and runoff)  <br /></td></tr>
<tr class="memitem:ga0f7c6c8dacb67eba3a21e7d4d3afc369" id="r_ga0f7c6c8dacb67eba3a21e7d4d3afc369"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga0f7c6c8dacb67eba3a21e7d4d3afc369.html#ga0f7c6c8dacb67eba3a21e7d4d3afc369">canwater</a> (parameters, vegtyp, dt, fcev, fctr, elai, esai, tg, fveg, iloc, jloc, bdfall, frozen_canopy, canliq, canice, tv, cmc, ecan, etran, fwet)</td></tr>
<tr class="memdesc:ga0f7c6c8dacb67eba3a21e7d4d3afc369"><td class="mdescLeft">&#160;</td><td class="mdescRight">canopy hydrology  <br /></td></tr>
<tr class="memitem:ga8500bdb5fcc68e431512068da0d31cd5" id="r_ga8500bdb5fcc68e431512068da0d31cd5"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga8500bdb5fcc68e431512068da0d31cd5.html#ga8500bdb5fcc68e431512068da0d31cd5">snowwater</a> (parameters, nsnow, nsoil, imelt, dt, zsoil, sfctmp, snowhin, qsnow, qsnfro, qsnsub, qrain, ficeold, iloc, jloc, isnow, snowh, sneqv, snice, snliq, sh2o, sice, stc, zsnso, dzsnso, qsnbot, snoflow, ponding1, ponding2)</td></tr>
<tr class="memitem:ga27b8403f2911888350b2ce246e3c6620" id="r_ga27b8403f2911888350b2ce246e3c6620"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga27b8403f2911888350b2ce246e3c6620.html#ga27b8403f2911888350b2ce246e3c6620">snowfall</a> (parameters, nsoil, nsnow, dt, qsnow, snowhin, sfctmp, iloc, jloc, isnow, snowh, dzsnso, stc, snice, snliq, sneqv)</td></tr>
<tr class="memdesc:ga27b8403f2911888350b2ce246e3c6620"><td class="mdescLeft">&#160;</td><td class="mdescRight">snow depth and density to account for the new snowfall. new values of snow depth &amp; density returned.  <br /></td></tr>
<tr class="memitem:ga0d1a0707cf2a2a4fd14444b111a55048" id="r_ga0d1a0707cf2a2a4fd14444b111a55048"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga0d1a0707cf2a2a4fd14444b111a55048.html#ga0d1a0707cf2a2a4fd14444b111a55048">combine</a> (parameters, nsnow, nsoil, iloc, jloc, isnow, sh2o, stc, snice, snliq, dzsnso, sice, snowh, sneqv, ponding1, ponding2)</td></tr>
<tr class="memitem:ga2a809bb1c3c3307616446d4f27d00d5c" id="r_ga2a809bb1c3c3307616446d4f27d00d5c"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga2a809bb1c3c3307616446d4f27d00d5c.html#ga2a809bb1c3c3307616446d4f27d00d5c">divide</a> (parameters, nsnow, nsoil, isnow, stc, snice, snliq, dzsnso)</td></tr>
<tr class="memitem:ga4804d8de40f7ea8a8cf4ed6e22ff4aa0" id="r_ga4804d8de40f7ea8a8cf4ed6e22ff4aa0"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga4804d8de40f7ea8a8cf4ed6e22ff4aa0.html#ga4804d8de40f7ea8a8cf4ed6e22ff4aa0">combo</a> (parameters, dz, wliq, wice, t, dz2, wliq2, wice2, t2)</td></tr>
<tr class="memitem:gabc66ddc0a33ac2d9fe3a1677febd1725" id="r_gabc66ddc0a33ac2d9fe3a1677febd1725"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gabc66ddc0a33ac2d9fe3a1677febd1725.html#gabc66ddc0a33ac2d9fe3a1677febd1725">compact</a> (parameters, nsnow, nsoil, dt, stc, snice, snliq, zsoil, imelt, ficeold, iloc, jloc, isnow, dzsnso, zsnso)</td></tr>
<tr class="memitem:gad5df8e19f96bc0e98560e5df8c49c0fa" id="r_gad5df8e19f96bc0e98560e5df8c49c0fa"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gad5df8e19f96bc0e98560e5df8c49c0fa.html#gad5df8e19f96bc0e98560e5df8c49c0fa">snowh2o</a> (parameters, nsnow, nsoil, dt, qsnfro, qsnsub, qrain, iloc, jloc, isnow, dzsnso, snowh, sneqv, snice, snliq, sh2o, sice, stc, qsnbot, ponding1, ponding2)</td></tr>
<tr class="memdesc:gad5df8e19f96bc0e98560e5df8c49c0fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">renew the mass of ice lens (snice) and liquid (snliq) of the surface snow layer resulting from sublimation (frost) / evaporation (dew)  <br /></td></tr>
<tr class="memitem:gadca44347d78a09297195f41298a47f8d" id="r_gadca44347d78a09297195f41298a47f8d"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gadca44347d78a09297195f41298a47f8d.html#gadca44347d78a09297195f41298a47f8d">soilwater</a> (parameters, nsoil, nsnow, dt, zsoil, dzsnso, qinsur, qseva, etrani, sice, iloc, jloc, sh2o, smc, zwt, vegtyp, smcwtd, deeprech, runsrf, qdrain, runsub, wcnd, fcrmax)</td></tr>
<tr class="memdesc:gadca44347d78a09297195f41298a47f8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate surface runoff and soil moisture.  <br /></td></tr>
<tr class="memitem:gadc2da87aeab4494d5234d18df3d223f7" id="r_gadc2da87aeab4494d5234d18df3d223f7"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gadc2da87aeab4494d5234d18df3d223f7.html#gadc2da87aeab4494d5234d18df3d223f7">zwteq</a> (parameters, nsoil, nsnow, zsoil, dzsnso, sh2o, zwt)</td></tr>
<tr class="memdesc:gadc2da87aeab4494d5234d18df3d223f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate equilibrium water table depth (niu et al., 2005)  <br /></td></tr>
<tr class="memitem:ga33eceb1b8d3e8a38dec1ca21f811f13d" id="r_ga33eceb1b8d3e8a38dec1ca21f811f13d"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga33eceb1b8d3e8a38dec1ca21f811f13d.html#ga33eceb1b8d3e8a38dec1ca21f811f13d">infil</a> (parameters, nsoil, dt, zsoil, sh2o, sice, sicemax, qinsur, pddum, runsrf)</td></tr>
<tr class="memdesc:ga33eceb1b8d3e8a38dec1ca21f811f13d"><td class="mdescLeft">&#160;</td><td class="mdescRight">compute inflitration rate at soil surface and surface runoff  <br /></td></tr>
<tr class="memitem:ga2825a3a5bbdeed71a7b6ea89ff9bce16" id="r_ga2825a3a5bbdeed71a7b6ea89ff9bce16"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga2825a3a5bbdeed71a7b6ea89ff9bce16.html#ga2825a3a5bbdeed71a7b6ea89ff9bce16">srt</a> (parameters, nsoil, zsoil, dt, pddum, etrani, qseva, sh2o, smc, zwt, fcr, sicemax, fcrmax, iloc, jloc, smcwtd, rhstt, ai, bi, ci, qdrain, wcnd)</td></tr>
<tr class="memdesc:ga2825a3a5bbdeed71a7b6ea89ff9bce16"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate the right hand side of the time tendency term of the soil water diffusion equation. also to compute (prepare) the matrix coefficients for the tri-diagonal matrix of the implicit time scheme.  <br /></td></tr>
<tr class="memitem:gae10b02d7df0104a84451abc57e0410fb" id="r_gae10b02d7df0104a84451abc57e0410fb"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gae10b02d7df0104a84451abc57e0410fb.html#gae10b02d7df0104a84451abc57e0410fb">sstep</a> (parameters, nsoil, nsnow, dt, zsoil, dzsnso, sice, iloc, jloc, zwt, sh2o, smc, ai, bi, ci, rhstt, smcwtd, qdrain, deeprech, wplus)</td></tr>
<tr class="memdesc:gae10b02d7df0104a84451abc57e0410fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate/update soil moisture content values.  <br /></td></tr>
<tr class="memitem:gaffab2571eaa0a1c94d971a5344c8a109" id="r_gaffab2571eaa0a1c94d971a5344c8a109"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gaffab2571eaa0a1c94d971a5344c8a109.html#gaffab2571eaa0a1c94d971a5344c8a109">wdfcnd1</a> (parameters, wdf, wcnd, smc, fcr, isoil)</td></tr>
<tr class="memdesc:gaffab2571eaa0a1c94d971a5344c8a109"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate soil water diffusivity and soil hydraulic conductivity.  <br /></td></tr>
<tr class="memitem:gaca325ee2efde047e6cd030ace7d5931f" id="r_gaca325ee2efde047e6cd030ace7d5931f"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gaca325ee2efde047e6cd030ace7d5931f.html#gaca325ee2efde047e6cd030ace7d5931f">wdfcnd2</a> (parameters, wdf, wcnd, smc, sice, isoil)</td></tr>
<tr class="memdesc:gaca325ee2efde047e6cd030ace7d5931f"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate soil water diffusivity and soil hydraulic conductivity.  <br /></td></tr>
<tr class="memitem:ga6ce8861ff5926b6f3efb1e7d8c552de1" id="r_ga6ce8861ff5926b6f3efb1e7d8c552de1"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga6ce8861ff5926b6f3efb1e7d8c552de1.html#ga6ce8861ff5926b6f3efb1e7d8c552de1">groundwater</a> (parameters, nsnow, nsoil, dt, sice, zsoil, stc, wcnd, fcrmax, iloc, jloc, sh2o, zwt, wa, wt, qin, qdis)</td></tr>
<tr class="memitem:ga027ec32eb5879830419538747eeb65a5" id="r_ga027ec32eb5879830419538747eeb65a5"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga027ec32eb5879830419538747eeb65a5.html#ga027ec32eb5879830419538747eeb65a5">shallowwatertable</a> (parameters, nsnow, nsoil, zsoil, dt, dzsnso, smceq, iloc, jloc, smc, wtd, smcwtd, rech, qdrain)</td></tr>
<tr class="memdesc:ga027ec32eb5879830419538747eeb65a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">diagnoses water table depth and computes recharge when the water table is within the resolved soil layers, according to the miguez-macho&amp;fan scheme.  <br /></td></tr>
<tr class="memitem:ga47b0778587d0eebbb80a3fef6bf2fcf4" id="r_ga47b0778587d0eebbb80a3fef6bf2fcf4"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga47b0778587d0eebbb80a3fef6bf2fcf4.html#ga47b0778587d0eebbb80a3fef6bf2fcf4">carbon</a> (parameters, nsnow, nsoil, vegtyp, dt, zsoil, dzsnso, stc, smc, tv, tg, psn, foln, btran, apar, fveg, igs, troot, ist, lat, iloc, jloc, lfmass, rtmass, stmass, wood, stblcp, fastcp, gpp, npp, nee, autors, heters, totsc, totlb, xlai, xsai)</td></tr>
<tr class="memitem:gaaa3ca7df06423ef038448f5380e59bcc" id="r_gaaa3ca7df06423ef038448f5380e59bcc"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gaaa3ca7df06423ef038448f5380e59bcc.html#gaaa3ca7df06423ef038448f5380e59bcc">co2flux</a> (parameters, nsnow, nsoil, vegtyp, igs, dt, dzsnso, stc, psn, troot, tv, wroot, wstres, foln, lapm, lat, iloc, jloc, fveg, xlai, xsai, lfmass, rtmass, stmass, fastcp, stblcp, wood, gpp, npp, nee, autors, heters, totsc, totlb)</td></tr>
<tr class="memdesc:gaaa3ca7df06423ef038448f5380e59bcc"><td class="mdescLeft">&#160;</td><td class="mdescRight">the original code is from Dickinson et al.(1998), modified by guo-yue niu, 2004  <br /></td></tr>
<tr class="memitem:ga1bfb46ef35c313c3034d7aaec2768ab0" id="r_ga1bfb46ef35c313c3034d7aaec2768ab0"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga1bfb46ef35c313c3034d7aaec2768ab0.html#ga1bfb46ef35c313c3034d7aaec2768ab0">carbon_crop</a> (parameters, nsnow, nsoil, vegtyp, dt, zsoil, julian, dzsnso, stc, smc, tv, psn, foln, btran, soldn, t2m, lfmass, rtmass, stmass, wood, stblcp, fastcp, grain, xlai, xsai, gdd, gpp, npp, nee, autors, heters, totsc, totlb, pgs)</td></tr>
<tr class="memdesc:ga1bfb46ef35c313c3034d7aaec2768ab0"><td class="mdescLeft">&#160;</td><td class="mdescRight">initial crop version created by xing liu initial crop version added by barlage v3.8  <br /></td></tr>
<tr class="memitem:gadd04c0bfaab0affe5cf403fd02911fb7" id="r_gadd04c0bfaab0affe5cf403fd02911fb7"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gadd04c0bfaab0affe5cf403fd02911fb7.html#gadd04c0bfaab0affe5cf403fd02911fb7">co2flux_crop</a> (parameters, dt, stc, psn, tv, wroot, wstres, foln, ipa, iha, pgs, xlai, xsai, lfmass, rtmass, stmass, fastcp, stblcp, wood, grain, gdd, gpp, npp, nee, autors, heters, totsc, totlb)</td></tr>
<tr class="memdesc:gadd04c0bfaab0affe5cf403fd02911fb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">the original code from re dickinson et al.(1998) and guo-yue niu (2004), modified by xing liu, 2014.  <br /></td></tr>
<tr class="memitem:ga28b723824475b09a7f98faa3a1a7a0f7" id="r_ga28b723824475b09a7f98faa3a1a7a0f7"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga28b723824475b09a7f98faa3a1a7a0f7.html#ga28b723824475b09a7f98faa3a1a7a0f7">growing_gdd</a> (parameters, t2m, dt, julian, gdd, ipa, iha, pgs)</td></tr>
<tr class="memitem:gad23bb5c7d0a8f256af7164497f2b884b" id="r_gad23bb5c7d0a8f256af7164497f2b884b"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gad23bb5c7d0a8f256af7164497f2b884b.html#gad23bb5c7d0a8f256af7164497f2b884b">psn_crop</a> (parameters, soldn, xlai, t2m, psncrop)</td></tr>
<tr class="memitem:ga2cbdbc23b78608c46a89cd4276c39b9a" id="r_ga2cbdbc23b78608c46a89cd4276c39b9a"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga2cbdbc23b78608c46a89cd4276c39b9a.html#ga2cbdbc23b78608c46a89cd4276c39b9a">noahmp_options</a> (idveg, iopt_crs, iopt_btr, iopt_run, iopt_sfc, iopt_frz, iopt_inf, iopt_rad, iopt_alb, iopt_snf, iopt_tbot, iopt_stc, iopt_rsf, iopt_soil, iopt_pedo, iopt_crop, iopt_trs, iopt_diag, iopt_z0m)</td></tr>
<tr class="memitem:ga4a88258da12057ced7c9dc5760b53d13" id="r_ga4a88258da12057ced7c9dc5760b53d13"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga4a88258da12057ced7c9dc5760b53d13.html#ga4a88258da12057ced7c9dc5760b53d13">sfcdif4</a> (iloc, jloc, ux, vx, t1d, p1d, psfcpa, pblhx, dx, znt, ep_1, ep_2, cp, itime, snwh, isice, psi_opt, tsk, qx, zlvl, iz0tlnd, qsfc, hfx, qfx, cm, chs, chs2, cqs2, rmolx, ust, rbx, fmx, fhx, stressx, fm10x, fh2x, wspdx, flhcx, flqcx)</td></tr>
<tr class="memitem:gaa1453a4f904aa171ea91510f464824b3" id="r_gaa1453a4f904aa171ea91510f464824b3"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gaa1453a4f904aa171ea91510f464824b3.html#gaa1453a4f904aa171ea91510f464824b3">zilitinkevich_1995</a> (z_0, zt, zq, restar, ustar, vkc, landsea, iz0tlnd2, spp_pbl, rstoch)</td></tr>
<tr class="memitem:ga88dbf6bdf1a8097e27b06ddfce89516c" id="r_ga88dbf6bdf1a8097e27b06ddfce89516c"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga88dbf6bdf1a8097e27b06ddfce89516c.html#ga88dbf6bdf1a8097e27b06ddfce89516c">garratt_1992</a> (zt, zq, z_0, ren, landsea)</td></tr>
<tr class="memdesc:ga88dbf6bdf1a8097e27b06ddfce89516c"><td class="mdescLeft">&#160;</td><td class="mdescRight">data. the formula for land uses a constant ratio (z_0/7.4) taken from garratt (1992).  <br /></td></tr>
<tr class="memitem:gaf3953df98f080d251351c07a00956aee" id="r_gaf3953df98f080d251351c07a00956aee"><td class="memItemLeft">real *8 function&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gaf3953df98f080d251351c07a00956aee.html#gaf3953df98f080d251351c07a00956aee">zolri</a> (ri, za, z0, zt, zol1, psi_opt)</td></tr>
<tr class="memitem:ga33794c1f89d40a55548dfc108f2b3324" id="r_ga33794c1f89d40a55548dfc108f2b3324"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga33794c1f89d40a55548dfc108f2b3324.html#ga33794c1f89d40a55548dfc108f2b3324">psi_init</a> (psi_opt, errmsg, errflg)</td></tr>
<tr class="memitem:ga60b53486170b242b8233505746dc95a7" id="r_ga60b53486170b242b8233505746dc95a7"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga60b53486170b242b8233505746dc95a7.html#ga60b53486170b242b8233505746dc95a7">noahmpdrv_init</a> (lsm, lsm_noahmp, me, isot, ivegsrc, nlunit, pores, resid, do_mynnsfclay, do_mynnedmf, errmsg, errflg, land_iau_control, land_iau_data, land_iau_state)</td></tr>
<tr class="memdesc:ga60b53486170b242b8233505746dc95a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine is called during the CCPP initialization phase and calls set_soilveg() to initialize soil and vegetation parameters for the chosen soil and vegetation data sources.  <br /></td></tr>
<tr class="memitem:ga8469861c765352ebba74999172506fdd" id="r_ga8469861c765352ebba74999172506fdd"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga8469861c765352ebba74999172506fdd.html#ga8469861c765352ebba74999172506fdd">noahmpdrv_timestep_init</a> (itime, fhour, delt, km, ncols, isot, ivegsrc, soiltyp, vegtype, weasd, land_iau_control, land_iau_data, land_iau_state, stc, slc, smc, errmsg, errflg, con_g, con_t0c, con_hfus)</td></tr>
<tr class="memdesc:ga8469861c765352ebba74999172506fdd"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine is called before noahmpdrv_run to update states with iau increments, if available.  <br /></td></tr>
<tr class="memitem:gad941e2c4753d52064958fa28f30cd2f6" id="r_gad941e2c4753d52064958fa28f30cd2f6"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_gad941e2c4753d52064958fa28f30cd2f6.html#gad941e2c4753d52064958fa28f30cd2f6">noahmpdrv_finalize</a> (land_iau_control, land_iau_data, land_iau_state, errmsg, errflg)</td></tr>
<tr class="memdesc:gad941e2c4753d52064958fa28f30cd2f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine mirrors noahmpdrv_init <br  />
 it calls land_iau_finalize which frees up allocated memory by IAU_init (in noahmdrv_init).  <br /></td></tr>
<tr class="memitem:ga34d365b67170edc5de296f27543170c1" id="r_ga34d365b67170edc5de296f27543170c1"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga34d365b67170edc5de296f27543170c1.html#ga34d365b67170edc5de296f27543170c1">transfer_mp_parameters</a> (vegtype, soiltype, slopetype, soilcolor, croptype, parameters)</td></tr>
<tr class="memdesc:ga34d365b67170edc5de296f27543170c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine fills in a derived data type of type <a class="el" href="structnoahmp__parameters.html">noahmp_parameters</a> with data from the module <a class="el" href="namespacenoahmp__tables.html" title="noahmp_tables">noahmp_tables</a>.  <br /></td></tr>
<tr class="memitem:ga6a3cf4cbf8c17a2b894202cb058015a4" id="r_ga6a3cf4cbf8c17a2b894202cb058015a4"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga6a3cf4cbf8c17a2b894202cb058015a4.html#ga6a3cf4cbf8c17a2b894202cb058015a4">pedotransfer_sr2006</a> (nsoil, sand, clay, orgm, parameters)</td></tr>
<tr class="memdesc:ga6a3cf4cbf8c17a2b894202cb058015a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine uses a pedotransfer method to calculate soil properties.  <br /></td></tr>
<tr class="memitem:ga3cdcb6765bc055f74a9442ab7520aa5a" id="r_ga3cdcb6765bc055f74a9442ab7520aa5a"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga3cdcb6765bc055f74a9442ab7520aa5a.html#ga3cdcb6765bc055f74a9442ab7520aa5a">penman</a> (sfctmp, sfcprs, ch, t2v, th2, prcp, fdown, ssoil, q2, q2sat, etp, snowng, frzgra, ffrozp, dqsdt2, emissi_in, sncovr)</td></tr>
<tr class="memdesc:ga3cdcb6765bc055f74a9442ab7520aa5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">brief Calculate potential evaporation for the current point. Various partial sums/products are also calculated and passed back to the calling routine for later use.  <br /></td></tr>
<tr class="memitem:ga0e44f72a92d8830344fecdb9fb65e6fb" id="r_ga0e44f72a92d8830344fecdb9fb65e6fb"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group___noah_m_p___l_s_m_ga0e44f72a92d8830344fecdb9fb65e6fb.html#ga0e44f72a92d8830344fecdb9fb65e6fb">noahmpdrv_run</a> (im, km, lsnowl, itime, ps, u1, v1, t1, q1, soiltyp, soilcol, vegtype, sigmaf, dlwflx, dswsfc, snet, delt, tg3, cm, ch, prsl1, prslk1, prslki, prsik1, zf, pblh, dry, wind, slopetyp, shdmin, shdmax, snoalb, sfalb, flag_iter, con_g, idveg, iopt_crs, iopt_btr, iopt_run, iopt_sfc, iopt_frz, iopt_inf, iopt_rad, iopt_alb, iopt_snf, iopt_tbot, iopt_stc, iopt_trs, iopt_diag, xlatin, xcoszin, iyrlen, julian, garea, rainn_mp, rainc_mp, snow_mp, graupel_mp, ice_mp, rhonewsn1, con_hvap, con_cp, con_jcal, rhoh2o, con_eps, con_epsm1, con_fvirt, con_rd, con_hfus, thsfc_loc, cpllnd, cpllnd2atm, weasd, snwdph, tskin, tprcp, srflag, smc, stc, slc, canopy, trans, tsurf, zorl, rb1, fm1, fh1, ustar1, stress1, fm101, fh21, rmol1, flhc1, flqc1, do_mynnsfclay, snowxy, tvxy, tgxy, canicexy, canliqxy, eahxy, tahxy, cmxy, chxy, fwetxy, sneqvoxy, alboldxy, qsnowxy, wslakexy, zwtxy, waxy, wtxy, tsnoxy, zsnsoxy, snicexy, snliqxy, lfmassxy, rtmassxy, stmassxy, woodxy, stblcpxy, fastcpxy, xlaixy, xsaixy, taussxy, smoiseq, smcwtdxy, deeprechxy, rechxy, albdvis, albdnir, albivis, albinir, emiss, sncovr1, qsurf, gflux, drain, evap, hflx, ep, runoff, cmm, chh, evbs, evcw, sbsno, pah, ecan, etran, edir, snowc, stm, snohf, smcwlt2, smcref2, wet1, t2mmp, q2mp, zvfun, ztmax, rca, errmsg, errflg, canopy_heat_storage_ccpp, rainfall_ccpp, sw_absorbed_total_ccpp, sw_reflected_total_ccpp, lw_absorbed_total_ccpp, temperature_bare_grd_ccpp, temperature_veg_grd_ccpp, temperature_veg_2m_ccpp, temperature_bare_2m_ccpp, spec_humidity_veg_2m_ccpp, spec_humidity_bare_2m_ccpp, sw_absorbed_veg_ccpp, sw_absorbed_ground_ccpp, snowmelt_out_ccpp, snowmelt_shallow_ccpp, albedo_direct_snow_ccpp, albedo_diffuse_snow_ccpp, ch_vegetated_ccpp, ch_bare_ground_ccpp, sensible_heat_grd_veg_ccpp, sensible_heat_leaf_ccpp, sensible_heat_grd_bar_ccpp, latent_heat_grd_veg_ccpp, latent_heat_grd_bare_ccpp, ground_heat_veg_ccpp, ground_heat_bare_ccpp, lw_absorbed_grd_veg_ccpp, lw_absorbed_leaf_ccpp, lw_absorbed_grd_bare_ccpp, latent_heat_trans_ccpp, latent_heat_leaf_ccpp, ch_leaf_ccpp, ch_below_canopy_ccpp, ch_vegetated_2m_ccpp, ch_bare_ground_2m_ccpp, precip_adv_heat_veg_ccpp, precip_adv_heat_grd_v_ccpp, precip_adv_heat_grd_b_ccpp, spec_humid_sfc_veg_ccpp, spec_humid_sfc_bare_ccpp)</td></tr>
<tr class="memdesc:ga0e44f72a92d8830344fecdb9fb65e6fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine is the main CCPP entry point for the NoahMP LSM.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"></div></div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
    toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
    toggleButton.title = "Toggle Light/Dark Mode"
    $(document).ready(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
    // every resize will remove the button, which is why it has to be added again:
    $(window).resize(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
  })
</script>
</body>
</html>
