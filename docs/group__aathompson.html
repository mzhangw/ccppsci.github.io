<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="CCPP SciDoc" />
<meta property="og:image" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta property="og:description" content="CCPP Scientific Documentation" />
<meta property="og:url" content="https://github.com/ufs-community/ccpp-physics" />
<!-- END opengraph metadata -->
<title>CCPP SciDoc v7.0.0: Aerosol-Aware Thompson MP Module</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-ccpp.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/ufs-community/ccpp-physics" class="github-corner" title="View source on GitHub" target="_blank" rel="noopener noreferrer">
    <svg viewBox="0 0 250 250" width="60" height="60" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="dtc_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CCPP SciDoc v7.0.0
   &#160;<span id="projectnumber">v7.0.0</span>
   </div>
   <div id="projectbrief">Common Community Physics Package Developed at DTC</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('group__aathompson.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Aerosol-Aware Thompson MP Module </div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-namespaces" class="groupheader"><a id="namespaces" name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:module_5Fmp_5Fradar" id="r_module_5Fmp_5Fradar"><td class="memItemLeft">module &#160;</td><td class="memItemRight"><a class="el" href="namespacemodule__mp__radar.html">module_mp_radar</a></td></tr>
<tr class="memdesc:namespacemodule__mp__radar"><td class="mdescLeft">&#160;</td><td class="mdescRight">This module is more library code whereas the individual microphysics schemes contains specific details needed for the final computation, so refer to location within each schemes calling the routine named rayleigh_soak_wetgraupel. <br /></td></tr>
<tr class="memitem:module_5Fmp_5Fthompson" id="r_module_5Fmp_5Fthompson"><td class="memItemLeft">module &#160;</td><td class="memItemRight"><a class="el" href="namespacemodule__mp__thompson.html">module_mp_thompson</a></td></tr>
<tr class="memdesc:namespacemodule__mp__thompson"><td class="mdescLeft">&#160;</td><td class="mdescRight">This module computes the moisture tendencies of water vapor, cloud droplets, rain, cloud ice (pristine), snow, and graupel. Prior to WRFv2.2 this code was based on Reisner et al (1998), but few of those pieces remain. A complete description is now found in Thompson, G., P. R. Field, R. M. Rasmussen, and W. D. Hall, 2008: Explicit Forecasts of winter precipitation using an improved bulk microphysics scheme. Part II: Implementation of a new snow parameterization. Mon. Wea. Rev., 136, 5095-5115. <br /></td></tr>
<tr class="memitem:module_5Fmp_5Fthompson_5Fmake_5Fnumber_5Fconcentrations" id="r_module_5Fmp_5Fthompson_5Fmake_5Fnumber_5Fconcentrations"><td class="memItemLeft">module &#160;</td><td class="memItemRight"><a class="el" href="namespacemodule__mp__thompson__make__number__concentrations.html">module_mp_thompson_make_number_concentrations</a></td></tr>
<tr class="memdesc:namespacemodule__mp__thompson__make__number__concentrations"><td class="mdescLeft">&#160;</td><td class="mdescRight">This module ocntains lookup tables of radiative effective radius of cloud ice, rain and water. <br /></td></tr>
<tr class="memitem:mp_5Fthompson_5Fpre" id="r_mp_5Fthompson_5Fpre"><td class="memItemLeft">module &#160;</td><td class="memItemRight"><a class="el" href="namespacemp__thompson__pre.html">mp_thompson_pre</a></td></tr>
<tr class="memdesc:namespacemp__thompson__pre"><td class="mdescLeft">&#160;</td><td class="mdescRight">This module contains the pre-processing of Thompson cloud microphysics. <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:gac8e1edab321a87bea8898a2a6d7a2dca" id="r_gac8e1edab321a87bea8898a2a6d7a2dca"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_gac8e1edab321a87bea8898a2a6d7a2dca.html#gac8e1edab321a87bea8898a2a6d7a2dca">module_mp_tempo::tempo_finalize</a> ()</td></tr>
<tr class="memitem:ga2866f4960845ca563ff60572145da6fd" id="r_ga2866f4960845ca563ff60572145da6fd"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_ga2866f4960845ca563ff60572145da6fd.html#ga2866f4960845ca563ff60572145da6fd">module_mp_tempo_utils::table_ccnact</a> (errmess, errflag)</td></tr>
<tr class="memdesc:ga2866f4960845ca563ff60572145da6fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill the table of CCN activation data created from parcel model run by Trude Eidhammer with inputs of aerosol number concentration, vertical velocity, temperature, lognormal mean aerosol radius, and hygroscopicity, kappa. The data are read from external file and contain activated fraction of CCN for given conditions.  <br /></td></tr>
<tr class="memitem:gab812a9b110a35fdb5f5361322242990f" id="r_gab812a9b110a35fdb5f5361322242990f"><td class="memItemLeft">elemental real function&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_gab812a9b110a35fdb5f5361322242990f.html#gab812a9b110a35fdb5f5361322242990f">module_mp_tempo_utils::make_icenumber</a> (q_ice, temp)</td></tr>
<tr class="memdesc:gab812a9b110a35fdb5f5361322242990f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Table of lookup values of radiative effective radius of ice crystals as a function of Temperature from -94C to 0C. Taken from WRF RRTMG radiation code where it is attributed to Jon Egill Kristjansson and coauthors.  <br /></td></tr>
<tr class="memitem:gae63a5aa0f406c6481b3e641269a79686" id="r_gae63a5aa0f406c6481b3e641269a79686"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_gae63a5aa0f406c6481b3e641269a79686.html#gae63a5aa0f406c6481b3e641269a79686">module_mp_thompson::thompson_finalize</a> ()</td></tr>
<tr class="memitem:gac898e25fc9f98509e6110b13be2a0f47" id="r_gac898e25fc9f98509e6110b13be2a0f47"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_gac898e25fc9f98509e6110b13be2a0f47.html#gac898e25fc9f98509e6110b13be2a0f47">module_mp_thompson::qr_acr_qg</a></td></tr>
<tr class="memdesc:gac898e25fc9f98509e6110b13be2a0f47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rain collecting graupel (and inverse). Explicit CE integration.  <br /></td></tr>
<tr class="memitem:gabcd924082fb7889d94345fcd108bc7ae" id="r_gabcd924082fb7889d94345fcd108bc7ae"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_gabcd924082fb7889d94345fcd108bc7ae.html#gabcd924082fb7889d94345fcd108bc7ae">module_mp_thompson::qr_acr_qs</a></td></tr>
<tr class="memdesc:gabcd924082fb7889d94345fcd108bc7ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rain collecting snow (and inverse). Explicit CE integration.  <br /></td></tr>
<tr class="memitem:ga34268e7843bcf03d55653da295c51c0c" id="r_ga34268e7843bcf03d55653da295c51c0c"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_ga34268e7843bcf03d55653da295c51c0c.html#ga34268e7843bcf03d55653da295c51c0c">module_mp_thompson::freezeh2o</a> (threads)</td></tr>
<tr class="memdesc:ga34268e7843bcf03d55653da295c51c0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is a literal adaptation of Bigg (1954) probability of drops of a particular volume freezing. Given this probability, simply freeze the proportion of drops summing their masses.  <br /></td></tr>
<tr class="memitem:ga38c4bc57c8dd450c76cc65b1991cf23d" id="r_ga38c4bc57c8dd450c76cc65b1991cf23d"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_ga38c4bc57c8dd450c76cc65b1991cf23d.html#ga38c4bc57c8dd450c76cc65b1991cf23d">module_mp_thompson::qi_aut_qs</a></td></tr>
<tr class="memdesc:ga38c4bc57c8dd450c76cc65b1991cf23d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cloud ice converting to snow since portion greater than min snow size. Given cloud ice content (kg/m**3), number concentration (#/m**3) and gamma shape parameter, mu_i, break the distrib into bins and figure out the mass/number of ice with sizes larger than D0s. Also, compute incomplete gamma function for the integration of ice depositional growth from diameter=0 to D0s. Amount of ice depositional growth is this portion of distrib while larger diameters contribute to snow growth (as in Harrington et al. 1995).  <br /></td></tr>
<tr class="memitem:gaafc69c30a2dad10d06a05f1b7239926c" id="r_gaafc69c30a2dad10d06a05f1b7239926c"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_gaafc69c30a2dad10d06a05f1b7239926c.html#gaafc69c30a2dad10d06a05f1b7239926c">module_mp_thompson::table_efrw</a></td></tr>
<tr class="memdesc:gaafc69c30a2dad10d06a05f1b7239926c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Variable collision efficiency for rain collecting cloud water using method of Beard and Grover, 1974 if a/A less than 0.25; otherwise uses polynomials to get close match of Pruppacher &amp; Klett Fig 14-9.  <br /></td></tr>
<tr class="memitem:gab74dffc6baa178d41426700bfd1a08c6" id="r_gab74dffc6baa178d41426700bfd1a08c6"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_gab74dffc6baa178d41426700bfd1a08c6.html#gab74dffc6baa178d41426700bfd1a08c6">module_mp_thompson::table_efsw</a></td></tr>
<tr class="memdesc:gab74dffc6baa178d41426700bfd1a08c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Variable collision efficiency for snow collecting cloud water using method of Wang and Ji, 2000 except equate melted snow diameter to their "effective collision cross-section.".  <br /></td></tr>
<tr class="memitem:ga75c72a524f02f1a180d4c23dc93399fa" id="r_ga75c72a524f02f1a180d4c23dc93399fa"><td class="memItemLeft">real function&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_ga75c72a524f02f1a180d4c23dc93399fa.html#ga75c72a524f02f1a180d4c23dc93399fa">module_mp_thompson::eff_aero</a> (d, da, visc, rhoa, temp, species)</td></tr>
<tr class="memdesc:ga75c72a524f02f1a180d4c23dc93399fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to compute collision efficiency of collector species (rain, snow, graupel) of aerosols. Follows Wang et al, 2010, ACP, which follows Slinn (1983).  <br /></td></tr>
<tr class="memitem:gac5a7433b5bd00387f9fd1e9aa9356dc4" id="r_gac5a7433b5bd00387f9fd1e9aa9356dc4"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_gac5a7433b5bd00387f9fd1e9aa9356dc4.html#gac5a7433b5bd00387f9fd1e9aa9356dc4">module_mp_thompson::table_dropevap</a></td></tr>
<tr class="memdesc:gac5a7433b5bd00387f9fd1e9aa9356dc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integrate rain size distribution from zero to D-star to compute the number of drops smaller than D-star that evaporate in a single timestep. Drops larger than D-star dont evaporate entirely so do not affect number concentration.  <br /></td></tr>
<tr class="memitem:ga895d527bfbacc127a0fc6248f392b782" id="r_ga895d527bfbacc127a0fc6248f392b782"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_ga895d527bfbacc127a0fc6248f392b782.html#ga895d527bfbacc127a0fc6248f392b782">module_mp_thompson::table_ccnact</a> (errmess, errflag)</td></tr>
<tr class="memdesc:ga895d527bfbacc127a0fc6248f392b782"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill the table of CCN activation data created from parcel model run by Trude Eidhammer with inputs of aerosol number concentration, vertical velocity, temperature, lognormal mean aerosol radius, and hygroscopicity, kappa. The data are read from external file and contain activated fraction of CCN for given conditions.  <br /></td></tr>
<tr class="memitem:ga8e30975d5245b6397a02e7f147013753" id="r_ga8e30975d5245b6397a02e7f147013753"><td class="memItemLeft">real function&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_ga8e30975d5245b6397a02e7f147013753.html#ga8e30975d5245b6397a02e7f147013753">module_mp_thompson::activ_ncloud</a> (tt, ww, nccn, lsm_in)</td></tr>
<tr class="memdesc:ga8e30975d5245b6397a02e7f147013753"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve fraction of CCN that gets activated given the model temp, vertical velocity, and available CCN concentration. The lookup table (read from external file) has CCN concentration varying the quickest, then updraft, then temperature, then mean aerosol radius, and finally hygroscopicity, kappa.  <br /></td></tr>
<tr class="memitem:ga409e17891d433b3214f570828a824255" id="r_ga409e17891d433b3214f570828a824255"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_ga409e17891d433b3214f570828a824255.html#ga409e17891d433b3214f570828a824255">module_mp_thompson::gcf</a> (gammcf, a, x, gln)</td></tr>
<tr class="memdesc:ga409e17891d433b3214f570828a824255"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the incomplete gamma function q(a,x) evaluated by its continued fraction representation as gammcf.  <br /></td></tr>
<tr class="memitem:ga28690a3c274459f6eb11ab59d0ae5a44" id="r_ga28690a3c274459f6eb11ab59d0ae5a44"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_ga28690a3c274459f6eb11ab59d0ae5a44.html#ga28690a3c274459f6eb11ab59d0ae5a44">module_mp_thompson::gser</a> (gamser, a, x, gln)</td></tr>
<tr class="memdesc:ga28690a3c274459f6eb11ab59d0ae5a44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the incomplete gamma function p(a,x) evaluated by its series representation as gamser.  <br /></td></tr>
<tr class="memitem:gad2946a6deeab8b049fcd554d930f35c9" id="r_gad2946a6deeab8b049fcd554d930f35c9"><td class="memItemLeft">real function&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_gad2946a6deeab8b049fcd554d930f35c9.html#gad2946a6deeab8b049fcd554d930f35c9">module_mp_thompson::gammln</a> (xx)</td></tr>
<tr class="memdesc:gad2946a6deeab8b049fcd554d930f35c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the value ln(gamma(xx)) for xx &gt; 0.  <br /></td></tr>
<tr class="memitem:ga5126f9b7d52cd4d3e7b072907abb4257" id="r_ga5126f9b7d52cd4d3e7b072907abb4257"><td class="memItemLeft">real function&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_ga5126f9b7d52cd4d3e7b072907abb4257.html#ga5126f9b7d52cd4d3e7b072907abb4257">module_mp_thompson::gammp</a> (a, x)</td></tr>
<tr class="memitem:ga8a455cb4e751f42fa53a31bb47649767" id="r_ga8a455cb4e751f42fa53a31bb47649767"><td class="memItemLeft">real function&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_ga8a455cb4e751f42fa53a31bb47649767.html#ga8a455cb4e751f42fa53a31bb47649767">module_mp_thompson::wgamma</a> (y)</td></tr>
<tr class="memitem:ga9617073eff52abf98dd295c8cd83ef24" id="r_ga9617073eff52abf98dd295c8cd83ef24"><td class="memItemLeft">real function&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_ga9617073eff52abf98dd295c8cd83ef24.html#ga9617073eff52abf98dd295c8cd83ef24">module_mp_thompson::rslf</a> (p, t)</td></tr>
<tr class="memdesc:ga9617073eff52abf98dd295c8cd83ef24"><td class="mdescLeft">&#160;</td><td class="mdescRight">THIS FUNCTION CALCULATES THE LIQUID SATURATION VAPOR MIXING RATIO AS A FUNCTION OF TEMPERATURE AND PRESSURE.  <br /></td></tr>
<tr class="memitem:ga878bec15133532309ba3036cd2739510" id="r_ga878bec15133532309ba3036cd2739510"><td class="memItemLeft">real function&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_ga878bec15133532309ba3036cd2739510.html#ga878bec15133532309ba3036cd2739510">module_mp_thompson::rsif</a> (p, t)</td></tr>
<tr class="memdesc:ga878bec15133532309ba3036cd2739510"><td class="mdescLeft">&#160;</td><td class="mdescRight">THIS FUNCTION CALCULATES THE ICE SATURATION VAPOR MIXING RATIO AS A FUNCTION OF TEMPERATURE AND PRESSURE.  <br /></td></tr>
<tr class="memitem:ga52feed1483f3aa63a2a8d01a21489c1b" id="r_ga52feed1483f3aa63a2a8d01a21489c1b"><td class="memItemLeft">real function&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_ga52feed1483f3aa63a2a8d01a21489c1b.html#ga52feed1483f3aa63a2a8d01a21489c1b">module_mp_thompson::icedemott</a> (tempc, qv, qvs, qvsi, rho, nifa)</td></tr>
<tr class="memitem:gaea254a035f560f75d83530673a997d32" id="r_gaea254a035f560f75d83530673a997d32"><td class="memItemLeft">real function&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_gaea254a035f560f75d83530673a997d32.html#gaea254a035f560f75d83530673a997d32">module_mp_thompson::icekoop</a> (temp, qv, qvs, naero, dt)</td></tr>
<tr class="memdesc:gaea254a035f560f75d83530673a997d32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Newer research since Koop et al (2001) suggests that the freezing rate should be lower than original paper, so J_rate is reduced by two orders of magnitude.  <br /></td></tr>
<tr class="memitem:ga1e42711862ad3fe8f706888ba21be61d" id="r_ga1e42711862ad3fe8f706888ba21be61d"><td class="memItemLeft">real function&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_ga1e42711862ad3fe8f706888ba21be61d.html#ga1e42711862ad3fe8f706888ba21be61d">module_mp_thompson::delta_p</a> (yy, y1, y2, aa, bb)</td></tr>
<tr class="memdesc:ga1e42711862ad3fe8f706888ba21be61d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper routine for Phillips et al (2008) ice nucleation.  <br /></td></tr>
<tr class="memitem:gaad2dc0e156ec25e72253fd56169ca4a8" id="r_gaad2dc0e156ec25e72253fd56169ca4a8"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_gaad2dc0e156ec25e72253fd56169ca4a8.html#gaad2dc0e156ec25e72253fd56169ca4a8">module_mp_thompson::calc_effectrad</a> (t1d, p1d, qv1d, qc1d, nc1d, qi1d, ni1d, qs1d, re_qc1d, re_qi1d, re_qs1d, lsml, kts, kte)</td></tr>
<tr class="memdesc:gaad2dc0e156ec25e72253fd56169ca4a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute <em>radiation</em> effective radii of cloud water, ice, and snow. These are entirely consistent with microphysics assumptions, not constant or otherwise ad hoc as is internal to most radiation schemes. Since only the smallest snowflakes should impact radiation, compute from first portion of complicated Field number distribution, not the second part, which is the larger sizes.  <br /></td></tr>
<tr class="memitem:ga8a3937b93a8a3780c0f84ab6f333638c" id="r_ga8a3937b93a8a3780c0f84ab6f333638c"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_ga8a3937b93a8a3780c0f84ab6f333638c.html#ga8a3937b93a8a3780c0f84ab6f333638c">module_mp_thompson::calc_refl10cm</a> (qv1d, qc1d, qr1d, nr1d, qs1d, qg1d, t1d, p1d, dbz, rand1, kts, kte, ii, jj, melti, vt_dbz, first_time_step)</td></tr>
<tr class="memdesc:ga8a3937b93a8a3780c0f84ab6f333638c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute radar reflectivity assuming 10 cm wavelength radar and using Rayleigh approximation. Only complication is melted snow/graupel which we treat as water-coated ice spheres and use Uli Blahak's library of routines. The meltwater fraction is simply the amount of frozen species remaining from what initially existed at the melting level interface.  <br /></td></tr>
<tr class="memitem:gaf4b385f219715062e0f6f631a906a593" id="r_gaf4b385f219715062e0f6f631a906a593"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_gaf4b385f219715062e0f6f631a906a593.html#gaf4b385f219715062e0f6f631a906a593">module_mp_thompson::graupel_psd_parameters</a> (kts, kte, rand1, rg, ilamg, n0_g)</td></tr>
<tr class="memdesc:gaf4b385f219715062e0f6f631a906a593"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates graupel size distribution parameters.  <br /></td></tr>
<tr class="memitem:gaff7d32ce96fc67c5e7968195b1241291" id="r_gaff7d32ce96fc67c5e7968195b1241291"><td class="memItemLeft">real(wp) function&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_gaff7d32ce96fc67c5e7968195b1241291.html#gaff7d32ce96fc67c5e7968195b1241291">module_mp_thompson::hail_mass_99th_percentile</a> (kts, kte, qg, temperature, pressure, qv)</td></tr>
<tr class="memdesc:gaff7d32ce96fc67c5e7968195b1241291"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates graupel/hail maximum diameter.  <br /></td></tr>
<tr class="memitem:gae08f6576724b2eb553528c40ce5ee494" id="r_gae08f6576724b2eb553528c40ce5ee494"><td class="memItemLeft">elemental real function, public&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_gae08f6576724b2eb553528c40ce5ee494.html#gae08f6576724b2eb553528c40ce5ee494">module_mp_thompson_make_number_concentrations::make_icenumber</a> (q_ice, temp)</td></tr>
<tr class="memdesc:gae08f6576724b2eb553528c40ce5ee494"><td class="mdescLeft">&#160;</td><td class="mdescRight">Table of lookup values of radiative effective radius of ice crystals as a function of Temperature from -94C to 0C. Taken from WRF RRTMG radiation code where it is attributed to Jon Egill Kristjansson and coauthors.  <br /></td></tr>
<tr class="memitem:gabadc55a2eccf9a0fabe07a0dc44a5ae7" id="r_gabadc55a2eccf9a0fabe07a0dc44a5ae7"><td class="memItemLeft">elemental real function, public&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_gabadc55a2eccf9a0fabe07a0dc44a5ae7.html#gabadc55a2eccf9a0fabe07a0dc44a5ae7">module_mp_thompson_make_number_concentrations::make_dropletnumber</a> (q_cloud, qnwfa)</td></tr>
<tr class="memitem:ga7c3bd9f7fe2f451e14dfdb0c548aea59" id="r_ga7c3bd9f7fe2f451e14dfdb0c548aea59"><td class="memItemLeft">elemental real function, public&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_ga7c3bd9f7fe2f451e14dfdb0c548aea59.html#ga7c3bd9f7fe2f451e14dfdb0c548aea59">module_mp_thompson_make_number_concentrations::make_rainnumber</a> (q_rain, temp)</td></tr>
<tr class="memitem:ga913721b93920f568db16540ff0dac1e9" id="r_ga913721b93920f568db16540ff0dac1e9"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_ga913721b93920f568db16540ff0dac1e9.html#ga913721b93920f568db16540ff0dac1e9">module_mp_thompson::thompson_init</a> (is_aerosol_aware_in, merra2_aerosol_aware_in, mpicomm, mpirank, mpiroot, threads, errmsg, errflg)</td></tr>
<tr class="memdesc:ga913721b93920f568db16540ff0dac1e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine calculates simplified cloud species equations and create lookup tables in Thomspson scheme.  <br /></td></tr>
<tr class="memitem:ga91f91d9fdb9ec49b853861384a61d70a" id="r_ga91f91d9fdb9ec49b853861384a61d70a"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_ga91f91d9fdb9ec49b853861384a61d70a.html#ga91f91d9fdb9ec49b853861384a61d70a">module_mp_thompson::mp_gt_driver</a> (wrf_chem)</td></tr>
<tr class="memdesc:ga91f91d9fdb9ec49b853861384a61d70a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is a wrapper routine designed to transfer values from 3D to 1D.  <br /></td></tr>
<tr class="memitem:gab35ac4001561513747f53afcf6c9ac3b" id="r_gab35ac4001561513747f53afcf6c9ac3b"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_gab35ac4001561513747f53afcf6c9ac3b.html#gab35ac4001561513747f53afcf6c9ac3b">module_mp_thompson::mp_thompson</a> (wrf_chem)</td></tr>
<tr class="memdesc:gab35ac4001561513747f53afcf6c9ac3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine computes the moisture tendencies of water vapor, cloud droplets, rain, cloud ice (pristine), snow, and graupel. Previously this code was based on Reisner et al (1998), but few of those pieces remain. A complete description is now found in Thompson et al. (2004, 2008)<a class="el" href="citelist.html#CITEREF_thompson_2004">[193]</a> <a class="el" href="citelist.html#CITEREF_thompson_2008">[194]</a>.  <br /></td></tr>
<tr class="memitem:ga370acdf3f9e68e7cd204da816dbbafbc" id="r_ga370acdf3f9e68e7cd204da816dbbafbc"><td class="memItemLeft">subroutine, public&#160;</td><td class="memItemRight"><a class="el" href="group__aathompson_ga370acdf3f9e68e7cd204da816dbbafbc.html#ga370acdf3f9e68e7cd204da816dbbafbc">mp_thompson::mp_thompson_run</a> (ncol, nlev, con_g, con_rd, con_eps, convert_dry_rho, spechum, qc, qr, qi, qs, qg, ni, nr, is_aerosol_aware, merra2_aerosol_aware, nc, nwfa, nifa, nwfa2d, nifa2d, aero_ind_fdb, tgrs, prsl, phii, omega, sedi_semi, decfl, islmsk, dtp, dt_inner, first_time_step, istep, nsteps, prcp, rain, graupel, ice, snow, sr, refl_10cm, fullradar_diag, max_hail_diam_sfc, do_radar_ref, aerfld, mpicomm, mpirank, mpiroot, blkno, ext_diag, diag3d, reset_diag3d, spp_wts_mp, spp_mp, n_var_spp, spp_prt_list, spp_var_list, spp_stddev_cutoff, cplchm, pfi_lsan, pfl_lsan, is_initialized, errmsg, errflg)</td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"></div></div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
    toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
    toggleButton.title = "Toggle Light/Dark Mode"
    $(document).ready(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
    // every resize will remove the button, which is why it has to be added again:
    $(window).resize(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
  })
</script>
</body>
</html>
