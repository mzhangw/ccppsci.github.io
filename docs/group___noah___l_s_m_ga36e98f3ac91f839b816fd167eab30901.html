<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="CCPP SciDoc" />
<meta property="og:image" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta property="og:description" content="CCPP Scientific Documentation" />
<meta property="og:url" content="https://github.com/ufs-community/ccpp-physics" />
<!-- END opengraph metadata -->
<title>CCPP SciDoc v7.0.0: sflx::gfssflx</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-ccpp.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/ufs-community/ccpp-physics" class="github-corner" title="View source on GitHub" target="_blank" rel="noopener noreferrer">
    <svg viewBox="0 0 250 250" width="60" height="60" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="dtc_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CCPP SciDoc v7.0.0
   &#160;<span id="projectnumber">v7.0.0</span>
   </div>
   <div id="projectbrief">Common Community Physics Package Developed at DTC</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('group___noah___l_s_m_ga36e98f3ac91f839b816fd167eab30901.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="contents">
<a id="ga36e98f3ac91f839b816fd167eab30901" name="ga36e98f3ac91f839b816fd167eab30901"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga36e98f3ac91f839b816fd167eab30901">&#9670;&#160;</a></span>gfssflx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sflx::gfssflx </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>nsoil</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>couple</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>icein</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ffrozp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>dt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>zlvl</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(nsoil), intent(in)</td>          <td class="paramname"><span class="paramname"><em>sldpth</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>swdn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>swnet</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwdn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>sfcems</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>sfcprs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>sfctmp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>sfcspd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>prcp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>q2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>q2sat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>dqsdt2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>th2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>ivegsrc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>vegtyp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>soiltyp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>slopetyp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>shdmin</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>alb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>snoalb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>rhonewsn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>exticeden</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>bexpp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>xlaip</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lheatstrg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tbot</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>cmc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>t1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(nsoil), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>stc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(nsoil), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>smc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(nsoil), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>sh2o</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>sneqv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ch</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>cm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>)</td>          <td class="paramname"><span class="paramname"><em>z0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)</td>          <td class="paramname"><span class="paramname"><em>nroot</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>shdfac</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>snowh</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>albedo</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>eta</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>sheat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ec</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>edir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), dimension(nsoil), intent(out)</td>          <td class="paramname"><span class="paramname"><em>et</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ett</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>esnow</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>drip</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>dew</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>beta</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>etp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ssoil</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>flx1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>flx2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>flx3</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>runoff1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>runoff2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>runoff3</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>snomlt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>sncovr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>rc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>pc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>rsmin</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>xlai</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>rcs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>rct</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>rcq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>rcsoil</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>soilw</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>soilm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>smcwlt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>smcdry</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>smcref</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=<a class="el" href="namespacemachine_a9c27597607a0f2377d61d10a6adfa3a4.html#a9c27597607a0f2377d61d10a6adfa3a4">kind_phys</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>smcmax</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(out)</td>          <td class="paramname"><span class="paramname"><em>errmsg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)</td>          <td class="paramname"><span class="paramname"><em>errflg</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The land-surface model component was substantially upgraded from the Oregon State University (OSU) land surface model to EMC's new Noah Land Surface Model (Noah LSM) during the major implementation in the NCEP Global Forecast System (GFS) on May 31, 2005. Forecast System (GFS). The Noah LSM embodies about 10 years of upgrades (see <a class="el" href="citelist.html#CITEREF_chen_et_al_1996">[34]</a>, <a class="el" href="citelist.html#CITEREF_koren_et_al_1999">[110]</a>, <a class="el" href="citelist.html#CITEREF_ek_et_al_2003">[52]</a>) to its ancestor, the OSU LSM. The Noah LSM upgrade includes:</p><ul>
<li>An increase from two (10, 190 cm thick) to four soil layers (10, 30, 60, 100 cm thick)</li>
<li>Addition of frozen soil physics</li>
<li>Add glacial ice treatment</li>
<li>Two snowpack states (SWE, density)</li>
<li>New formulations for infiltration and runoff account for sub-grid variability in precipitation and soil moisture</li>
<li>Revised physics of the snowpack and its influence on surface heat fluxes and albedo</li>
<li>Higher canopy resistance</li>
<li>Spatially varying root depth</li>
<li>Surface fluxes weighted by snow cover fraction</li>
<li>Improved thermal conduction in soil/snow</li>
<li>Improved seasonality of green vegetation cover.</li>
<li>Improved evaporation treatment over bare soil and snowpack</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nsoil</td><td>integer, number of soil layers (&gt;=2 but &lt;=nsold) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">couple</td><td>integer, =0:uncoupled (land model only), =1:coupled with parent atmos model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">icein</td><td>integer, sea-ice flag (=1: sea-ice, =0: land) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ffrozp</td><td>real, flag for snow-rain detection (1.=snow, 0.=rain) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>real, time step (&lt;3600 sec) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zlvl</td><td>real, height abv atmos ground forcing vars ( \(m\)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sldpth</td><td>real, thickness of each soil layer ( \(m\)), nsoil </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">swdn</td><td>real, downward SW radiation flux ( \(W/m^2\)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">swnet</td><td>real, downward SW net (dn-up) flux ( \(W/m^2\)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwdn</td><td>real, downward LW radiation flux ( \(W/m^2\)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sfcems</td><td>real, sfc LW emissivity (fractional) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sfcprs</td><td>real, pressure at height zlvl above ground( \(Pa\)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sfctmp</td><td>real, air temp at height zlvl above ground ( \(K\)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sfcspd</td><td>real, wind speed at height zlvl above ground ( \(m s^{-1}\)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">prcp</td><td>real, precipitation rate ( \(kgm^{-2}s^{-1}\)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q2</td><td>real, mixing ratio at hght zlvl above ground ( \(kgkg^{-1}\)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q2sat</td><td>real, sat mixing ratio at zlvl above ground ( \(kgkg^{-1}\)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dqsdt2</td><td>real, slope of sat specific humidity curve at t=sfctmp ( \(kgkg^{-1}k^{-1}\)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">th2</td><td>real, air potential temperature at zlvl above ground ( \(K\)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ivegsrc</td><td>integer, sfc veg type data source UMD or IGBP </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vegtyp</td><td>integer, vegetation type (integer index) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">soiltyp</td><td>integer, soil type (integer index) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">slopetyp</td><td>integer, class of sfc slope (integer index) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">shdmin</td><td>real, min areal coverage of green veg (fraction) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alb</td><td>real, background snow-free sfc albedo (fraction) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">snoalb</td><td>real, max albedo over deep snow (fraction) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bexpp</td><td>real, perturbation of soil type "b" parameter (perturbation) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xlaip</td><td>real, perturbation of leave area index (perturbation) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lheatstrg</td><td>logical, flag for canopy heat storage parameterization </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tbot</td><td>real, bottom soil temp ( \(K\)) (local yearly-mean sfc air temp) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cmc</td><td>real, canopy moisture content ( \(m\)) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t1</td><td>real, ground/canopy/snowpack eff skin temp ( \(K\)) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">stc</td><td>real, soil temp ( \(K\)) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">smc</td><td>real, total soil moisture (vol fraction) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sh2o</td><td>real, unfrozen soil moisture (vol fraction), note: frozen part = smc-sh2o </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sneqv</td><td>real, water-equivalent snow depth ( \(m\)), note: snow density = snwqv/snowh </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ch</td><td>real, sfc exchange coeff for heat &amp; moisture ( \(ms^{-1}\)), note: conductance since it's been mult by wind </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cm</td><td>real, sfc exchange coeff for momentum ( \(ms^{-1}\)), note: conductance since it's been mult by wind </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">z0</td><td>real, roughness length ( \(m\)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nroot</td><td>integer, number of root layers </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">shdfac</td><td>real, aeral coverage of green veg (fraction) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">snowh</td><td>real, snow depth ( \(m\)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"><a class="el" href="group___noah_m_p___l_s_m_ga9d5adb20aca5b72a7e126136088e20d1.html#ga9d5adb20aca5b72a7e126136088e20d1" title="surface albedos. also fluxes (per unit incoming direct and diffuse radiation) reflected,...">albedo</a></td><td>real, sfc albedo incl snow effect (fraction) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">eta</td><td>real, downward latent heat flux ( \(W/m^2\)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sheat</td><td>real, downward sensible heat flux ( \(W/m^2\)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ec</td><td>real, canopy water evaporation ( \(W/m^2\)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">edir</td><td>real, direct soil evaporation ( \(W/m^2\)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">et</td><td>real, plant transpiration ( \(W/m^2\)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ett</td><td>real, total plant transpiration ( \(W/m^2\)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">esnow</td><td>real, sublimation from snowpack ( \(W/m^2\)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">drip</td><td>real, through-fall of precip and/or dew in excess of canopy water-holding capacity ( \(m\)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dew</td><td>real, dewfall (or frostfall for t&lt;273.15) ( \(m\)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">beta</td><td>real, ratio of actual/potential evap </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">etp</td><td>real, potential evaporation ( \(W/m^2\)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ssoil</td><td>real, upward soil heat flux ( \(W/m^2\)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">flx1</td><td>real, precip-snow sfc flux ( \(W/m^2\)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">flx2</td><td>real, freezing rain latent heat flux ( \(W/m^2\)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">flx3</td><td>real, phase-change heat flux from snowmelt ( \(W/m^2\)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">runoff1</td><td>real, surface runoff ( \(ms^{-1}\)) not infiltrating sfc </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">runoff2</td><td>real, sub sfc runoff ( \(ms^{-1}\)) (baseflow) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">runoff3</td><td>real, excess of porosity for a given soil layer </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">snomlt</td><td>real, snow melt ( \(m\)) (water equivalent) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sncovr</td><td>real, fractional snow cover </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rc</td><td>real, canopy resistance (s/m) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pc</td><td>real, plant coeff (fraction) where pc*etp=transpi </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rsmin</td><td>real, minimum canopy resistance (s/m) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xlai</td><td>real, leaf area index (dimensionless) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rcs</td><td>real, incoming solar rc factor (dimensionless) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rct</td><td>real, air temperature rc factor (dimensionless) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rcq</td><td>real, atoms vapor press deficit rc factor </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rcsoil</td><td>real, soil moisture rc factor (dimensionless) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">soilw</td><td>real, available soil moisture in root zone </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">soilm</td><td>real, total soil column moisture (frozen+unfrozen) ( \(m\)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">smcwlt</td><td>real, wilting point (volumetric) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">smcdry</td><td>real, dry soil moisture threshold (volumetric) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">smcref</td><td>real, soil moisture threshold (volumetric) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">smcmax</td><td>real, porosity (sat val of soil mois) </td></tr>
  </table>
  </dd>
</dl>
<h1 class="doxsection"><a class="anchor" id="general_sflx"></a>
GFS Noah LSM General Algorithm</h1>
<ul>
<li>Set ice = -1 and green vegetation fraction (shdfac) = 0 for glacial-ice land.</li>
</ul>
<ul>
<li>Calculate soil layer depth below ground.</li>
</ul>
<ul>
<li>For ice, set green vegetation fraction (shdfac) = 0. and set sea-ice layers of equal thickness and sum to 3 meters</li>
</ul>
<ul>
<li>Otherwise, calculate depth (negative) below ground from top skin sfc to bottom of each soil layer.</li>
</ul>
<ul>
<li>Call <a class="el" href="group___noah___l_s_m_ga1c19b4bae5de2a391c019b6778a58dad.html#ga1c19b4bae5de2a391c019b6778a58dad" title="This subroutine internally sets default values or optionally read-in via namelist i/o,...">redprm()</a> to set the land-surface paramters, including soil-type and veg-type dependent parameters.</li>
</ul>
<ul>
<li>Calculate perturbated soil type "b" parameter. Following Gehne et al. (2019) <a class="el" href="citelist.html#CITEREF_gehne_2019">[68]</a> , a perturbation of LAI "leaf area index" (xlaip) and a perturbation of the empirical exponent parameter b in the soil hydraulic conductivity calculation (bexpp) are added to account for the uncertainties of LAI and b associated with different vegetation types and soil types using a linear scaling. The spatial pattern of xlaip is drawn from a normal distribution with a standard deviation of 0.25 while makes the LAI between 0 and 8. The spatial pattern of bexpp is drawn from a normal distribution with a standard deviation of 0.4, and is bounded between -1 and 1.</li>
</ul>
<ul>
<li>Calculate perturbated leaf area index.</li>
</ul>
<ul>
<li>Initialize precipitation logicals.</li>
</ul>
<ul>
<li>Over sea-ice or glacial-ice, if water-equivalent snow depth (<em class="arg">sneqv</em>) below threshold lower bound (0.01 m for sea-ice, 0.10 m for glacial-ice), then set at lower bound and store the source increment in subsurface runoff/baseflow (runoff2).</li>
</ul>
<ul>
<li>For sea-ice and glacial-ice cases, set smc and sh2o values = 1.0 as a flag for non-soil medium.</li>
</ul>
<ul>
<li>If input snowpack (<em class="arg">sneqv</em>) is nonzero, then call <a class="el" href="group___noah___l_s_m_ga028fc448a3afe77726222a337008ffa4.html#ga028fc448a3afe77726222a337008ffa4" title="This subroutine calculates snow termal conductivity.">csnow()</a> to compute snow density (<em class="arg">sndens</em>) and snow thermal conductivity (<em class="arg">sncond</em>).</li>
</ul>
<ul>
<li>Determine if it's precipitating and what kind of precipitation it is. if it's precipitating and the air temperature is colder than \(0^oC\), it's snowing! if it's precipitating and the air temperature is warmer than \(0^oC\), but the ground temperature is colder than \(0^oC\), freezing rain is presumed to be falling.</li>
</ul>
<ul>
<li>If either precipitation flag (<em class="arg">snowng</em>, <em class="arg">frzgra</em>) is set as true:</li>
</ul>
<ul>
<li>Since all precip is added to snowpack, no precip infiltrates into the soil so that <em class="arg">prcp1</em> is set to zero.</li>
</ul>
<ul>
<li>Call <a class="el" href="group___noah___l_s_m_gab816dbe84c4db91178251b08553c6d02.html#gab816dbe84c4db91178251b08553c6d02" title="This subroutine calculates snow depth and densitity to account for the new snowfall....">snow_new()</a> to update snow density based on new snowfall, using old and new snow.</li>
</ul>
<ul>
<li>Call <a class="el" href="group___noah___l_s_m_ga028fc448a3afe77726222a337008ffa4.html#ga028fc448a3afe77726222a337008ffa4" title="This subroutine calculates snow termal conductivity.">csnow()</a> to update snow thermal conductivity.</li>
</ul>
<ul>
<li>If precipitation is liquid (rain), hence save in the precip variable that later can wholely or partially infiltrate the soil (along with any canopy "drip" added to this later).</li>
</ul>
<ul>
<li>Determine snowcover fraction and albedo fraction over sea-ice, glacial-ice, and land.</li>
</ul>
<ul>
<li>Call <a class="el" href="group___noah___l_s_m_gafca324f1a0f2bcca12116291bfc8ad68.html#gafca324f1a0f2bcca12116291bfc8ad68" title="This subroutine calculates snow fraction (0-&gt;1).">snfrac()</a> to calculate snow fraction cover.</li>
</ul>
<ul>
<li>Call <a class="el" href="group___noah___l_s_m_ga18a0f02e4a1a32b6cde35cbe67b09908.html#ga18a0f02e4a1a32b6cde35cbe67b09908" title="This subroutine calculates albedo including snow effect (0 -&gt; 1).">alcalc()</a> to calculate surface albedo modification due to snowdepth state.</li>
</ul>
<ul>
<li>Calculate thermal diffusivity (<em class="arg">df1</em>):<ul>
<li>For sea-ice case and glacial-ice case, this is constant( \(df1=2.2\)).</li>
</ul>
</li>
</ul>
<ul>
<li>For non-glacial land case, call <a class="el" href="group___noah___l_s_m_ga8bc3154096e6364c5fcddf884c003bef.html#ga8bc3154096e6364c5fcddf884c003bef" title="This subroutine calculates thermal diffusivity and conductivity of the soil for a given point and tim...">tdfcnd()</a> to calculate the thermal diffusivity of top soil layer (<a class="el" href="citelist.html#CITEREF_peters-lidard_et_al_1998">[163]</a>).</li>
</ul>
<ul>
<li>Add subsurface heat flux reduction effect from the overlying green canopy, adapted from section 2.1.2 of <a class="el" href="citelist.html#CITEREF_peters-lidard_et_al_1997">[162]</a>.</li>
</ul>
<ul>
<li>Calculate subsurface heat flux, <em class="arg">ssoil</em>, from final thermal diffusivity of surface mediums,<em class="arg">df1</em> above, and skin temperature and top mid-layer soil temperature.</li>
</ul>
<ul>
<li>For uncoupled mode, call <a class="el" href="group___noah___l_s_m_ga95d889f436d70014fe640fa1b2420545.html#ga95d889f436d70014fe640fa1b2420545" title="This subroutine calculates total roughness length over snow.">snowz0()</a> to calculate surface roughness (<em class="arg">z0</em>) over snowpack using snow condition from the previous timestep.</li>
</ul>
<ul>
<li>Calculate virtual temps and virtual potential temps needed by subroutines sfcdif and penman.</li>
</ul>
<ul>
<li>Calculate the total downward radiation (<em class="arg">fdown</em>) = net solar (<em class="arg">swnet</em>) + downward longwave (<em class="arg">lwdn</em>) as input of <a class="el" href="group___noah___l_s_m_ga25b90f8a8049eb17cc6cb6a3fecf3fdc.html#ga25b90f8a8049eb17cc6cb6a3fecf3fdc" title="This subroutine calculates potential evaporation for the current point. various partial sums/products...">penman()</a> and other surface energy budget calculations.</li>
</ul>
<ul>
<li>Call <a class="el" href="group___noah___l_s_m_ga25b90f8a8049eb17cc6cb6a3fecf3fdc.html#ga25b90f8a8049eb17cc6cb6a3fecf3fdc" title="This subroutine calculates potential evaporation for the current point. various partial sums/products...">penman()</a> to calculate potential evaporation (<em class="arg">etp</em>), and other partial products and sums for later calculations.</li>
</ul>
<ul>
<li>Call <a class="el" href="group___noah___l_s_m_gaa292bfa0bd38e58ab9389cb38e4d09c0.html#gaa292bfa0bd38e58ab9389cb38e4d09c0" title="This subroutine calculates canopy resistance which depends on incoming solar radiation,...">canres()</a> to calculate the canopy resistance and convert it into pc if nonzero greenness fraction.</li>
</ul>
<ul>
<li>Now decide major pathway branch to take depending on whether snowpack exists or not:</li>
</ul>
<ul>
<li>For no snowpack is present, call <a class="el" href="group___noah___l_s_m_ga92994e4737ecfd692a6704778558c9c2.html#ga92994e4737ecfd692a6704778558c9c2" title="This subroutine calculates soil moisture and heat flux values and update soil moisture content and so...">nopac()</a> to calculate soil moisture and heat flux values and update soil moisture contant and soil heat content values.</li>
</ul>
<ul>
<li>For a snowpack is present, call <a class="el" href="group___noah___l_s_m_gad65a889bf3f431ade2a312674671ab41.html#gad65a889bf3f431ade2a312674671ab41" title="This subroutine calculates soil moisture and heat flux values and update soil moisture content and so...">snopac()</a>.</li>
</ul>
<ul>
<li>Noah LSM post-processing:<ul>
<li>Calculate sensible heat (h) for return to parent model.</li>
</ul>
</li>
</ul>
<ul>
<li>Convert units and/or sign of total evap (eta), potential evap (etp), subsurface heat flux (s), and runoffs for what parent model expects.</li>
</ul>
<ul>
<li>Convert the sign of soil heat flux so that:<ul>
<li>ssoil&gt;0: warm the surface (night time)</li>
<li>ssoil&lt;0: cool the surface (day time)</li>
</ul>
</li>
</ul>
<ul>
<li>For the case of land (but not glacial-ice): convert runoff3 (internal layer runoff from supersat) from \(m\) to \(ms^-1\) and add to subsurface runoff/baseflow (runoff2). runoff2 is already a rate at this point.</li>
</ul>
<ul>
<li>For the case of sea-ice (ice=1) or glacial-ice (ice=-1), add any snowmelt directly to surface runoff (runoff1) since there is no soil medium, and thus no call to subroutine smflx (for soil moisture tendency).</li>
</ul>
<ul>
<li>Calculate total column soil moisture in meters (soilm) and root-zone soil moisture availability (fraction) relative to porosity/saturation.</li>
</ul>

<p class="definition">Definition at line <a class="el" href="sflx_8f_source.html#l00116">116</a> of file <a class="el" href="sflx_8f_source.html">sflx.f</a>.</p>

<p class="reference">References <a class="el" href="module__sf__noahmplsm_8_f90_source.html#l02918">albedo()</a>, <a class="el" href="sflx_8f_source.html#l00989">alcalc()</a>, <a class="el" href="sflx_8f_source.html#l01075">canres()</a>, <a class="el" href="sflx_8f_source.html#l01229">csnow()</a>, <a class="el" href="sflx_8f_source.html#l01293">nopac()</a>, <a class="el" href="sflx_8f_source.html#l01572">penman()</a>, <a class="el" href="sflx_8f_source.html#l01683">redprm()</a>, <a class="el" href="sflx_8f_source.html#l01986">sfcdif()</a>, <a class="el" href="sflx_8f_source.html#l02272">snfrac()</a>, <a class="el" href="sflx_8f_source.html#l02344">snopac()</a>, <a class="el" href="sflx_8f_source.html#l02871">snow_new()</a>, <a class="el" href="sflx_8f_source.html#l02948">snowz0()</a>, and <a class="el" href="sflx_8f_source.html#l03005">tdfcnd()</a>.</p>

<p class="reference">Referenced by <a class="el" href="lsm__noah_8f_source.html#l00233">lsm_noah::lsm_noah_run()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" loading="lazy" frameborder="0" src="group___noah___l_s_m_ga36e98f3ac91f839b816fd167eab30901_ga36e98f3ac91f839b816fd167eab30901_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="group___noah___l_s_m_ga36e98f3ac91f839b816fd167eab30901_ga36e98f3ac91f839b816fd167eab30901_icgraph.svg" width="315" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="namespacesflx.html">sflx</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
    toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
    toggleButton.title = "Toggle Light/Dark Mode"
    $(document).ready(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
    // every resize will remove the button, which is why it has to be added again:
    $(window).resize(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
  })
</script>
</body>
</html>
