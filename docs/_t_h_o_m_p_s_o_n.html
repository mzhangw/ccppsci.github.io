<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="CCPP SciDoc" />
<meta property="og:image" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta property="og:description" content="CCPP Scientific Documentation" />
<meta property="og:url" content="https://github.com/ufs-community/ccpp-physics" />
<!-- END opengraph metadata -->
<title>CCPP SciDoc v7.0.0: Thompson Aerosol-Aware Cloud Microphysics Scheme</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-ccpp.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/ufs-community/ccpp-physics" class="github-corner" title="View source on GitHub" target="_blank" rel="noopener noreferrer">
    <svg viewBox="0 0 250 250" width="60" height="60" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="dtc_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CCPP SciDoc v7.0.0
   &#160;<span id="projectnumber">v7.0.0</span>
   </div>
   <div id="projectbrief">Common Community Physics Package Developed at DTC</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('_t_h_o_m_p_s_o_n.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Thompson Aerosol-Aware Cloud Microphysics Scheme </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1 class="doxsection"><a class="anchor" id="thompson_descrp"></a>
Description</h1>
<p>The scheme computes sources, sinks, and conversions for the mixing ratios of cloud water, rainwater, cloud ice, snow, and graupel. Number concentration for cloud ice (particles per cubic meter) is also forecast, based on statistical relationships of number concentration, density, and ice mass from recent observational studies. Since April 2014 (WRFv3.6), this is also the "aerosol-aware" scheme as described in Thompson and Eidhammer (2014) <a class="el" href="citelist.html#CITEREF_thompson_2014">[192]</a> .</p>
<p>The original RAP/HRRR microphysics implementation represents the most aggressive attempt to include explicit prediction of cloud and precipitation microphysical processes in the NCEP operational forecast model suite. The RAP and HRRR are important guidance to NWS aviation forecasts, and any microphysics improvements are aimed at least in part, to improve that guidance. The scheme is particularly beneficial for aircraft icing forecasts. Recently, this scheme is now being tested with a GFS_v17 prototype: the GFS_v17_HR3 suite at Environmental Modeling Center (EMC) as a candidate for the next operational implementation.</p>
<p>The microphysical processes accounted for are shown in the graphic below: </p><div class="image">
<img src="gsd_thompson.png" alt="" width="500"/>
<div class="caption">
Figure 1: Complex Microphysics Model in the RAP</div></div>
<p>Descriptions of these preocesses follow:</p><ul>
<li><b>Deposition:</b> Diffusional growth of ice particles under conditions of vapor supersaturation with respect to ice. Growth is "aerosol-aware", meaning the number of ice-friendly nulei and ice crystals is estimated by the microphysics scheme. Deposition of ice is estimated using the properties of these ice-friendly aerosols. Latent heat associated with the phase change from vapor to ice is released to the atmosphere.</li>
<li><b>Sublimation:</b> Diffusional shrinkage of ice particles under conditions of vapor subsaturation with respect to ice. The effect of aerosols on the sublimation process is estimated. Latent heat associated with the phase change from ice to vapor is removed from the atmosphere.</li>
<li><b>Riming:</b> Rapid freezing of supercooled cloud-size drops as a result of collisions with frozen precipitation particles, or foreign objects with sub \(0^{o}C\) surface temperatures, such as airplane wings. Latent heat of freezing is released to the atmosphere during the process.</li>
<li><b>Evaporation:</b> Process by which liquid is transformed into the gaseous state. The evaporation process is "aerosol-aware" through estimation of aerosol impacts. Latent heat is removed from the atmosphere and stored in water vapor during this process.</li>
<li><b>Condensation:</b> Process by which vapor is transformed into a liquid state. The impact of aerosols on condensation is estimated. latent heat is released into the atmosphere during this process.</li>
<li><b>Ice</b> <b>multiplication:</b> Formation of small ice particles as a result of freezing of supercooled cloud or raindrops. Ice multiplication occurs only under very restrictive conditions, but can be a large source of ice particles when these conditions are met.</li>
<li><b>Aggregation/autoconversion</b> <b>of</b> <b>snow:</b> Process through which frozen precipitation particles grow by collision and the assimilation of cloud particles or other precipitation particles. The autoconversion rate increases as ambient temperatures rise toward freezing.</li>
<li><b>Accretion/autoconversion</b> <b>of</b> <b>cloud</b> <b>liquid:</b> Process through which some cloud drops grow to become raindrops by collision and the assimilation of cloud drops.</li>
<li><b>Supercooled</b> <b>water</b> <b>formation:</b> Liquid cloud particles that remain in their liquid state despite being cooled below the freezing point of water.</li>
</ul>
<p>The scheme also assumes precipitation particle-size distributions for the three predicted precipitation types: rain, snow, and graupel. These size distributions are requied to emulate growth of precipitation by accretion of cloud-size particles, coalescence with other precipitation particles, and fall speeds of precipitation hydrometeors. The rainwater fall speed depends on the rainwater mixing ratio, with small values associated with fall speeds (and allowing the model to parameterize the behavior) of drizzle. The forecast precipitation type is based on what prognostic precipitation type actually reaches the surface (Benjamin et al.(2016) <a class="el" href="citelist.html#CITEREF_benjamin_2016b">[19]</a> )</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md5"></a>
Advantages of the Thompson Scheme and Updating Cloud Fields</h1>
<p>Some of the more general advantages of the upgraded MP scheme implementation in the RAP on the model's cloud and precipitation forecasts are listed below.</p>
<ul>
<li>Includes five hydrometeor types and their interactions, plus a sixth forecast variable for cloud ice number concentration. Drizzle is parameterized through using low fall velocities when there are low rain mixing ratios.</li>
<li>Includes impact of types of aerosol on condensation of water/deposition of ice</li>
<li>Accounts for horizontal and vertical advection of hydrometeors</li>
<li>Allows for more accurate prediction of precipitation in the form of snow, because slow fall velocities give time for snow to advect between grid columns</li>
<li>Includes cloud ice sedimentation, which positively influences RH and cloud forecasts</li>
<li>Because the scheme is a relatively complete mixed-phase scheme, it can account for the formation of supercooled water, a prerequisite for the model to provide useful guidance for aircraft icing forecasts</li>
<li>Can account for cloud phase changes and provides a sound physical basis for diagnosing precipitation type reaching the ground</li>
</ul>
<p>Recently, three mechanisms have been implemented to improve the stability of the scheme for weather forecast applications: <em class="arg">inner</em> <em class="arg">loop</em>, <em class="arg">subcycle</em>, and <em class="arg">semi-Lagrangian</em> <em class="arg">sedimentation</em> <em class="arg">of</em> <em class="arg">rain</em> <em class="arg">and</em> <em class="arg">graupel</em>. The inner loop and the subcycle are similar in that the physics time step is subdivided and the scheme is activated more often than others in the physics suite. However, they differ in implementation. With the inner loop method, namelist variable <code class="param">dt_inner</code> is used to set the short step. Conversely, the subcycle method is controlled by CCPP Framework through the "subcycle loop" in the suite definition file. The two methods should be used exclusively. The Semi-Lagrangian sedimentation of rain and graupel (based on Juang and Hong 2010 <a class="el" href="citelist.html#CITEREF_henry_juang_2010">[87]</a> ) increases numerical stability by applying the subtime step only to sedimentation computation. Two namelist variables control the usage of the semi-Lagrangian sedimentation, <code class="param">sedi_semi</code> and <code class="param">decfl</code>. <code class="param">sedi_semi</code> is set to ‘true’ to activate the method. <code class="param">Decfl</code> is a parameter that needs to avoid deformation of the arriving grids, currently, "10".</p>
<h1 class="doxsection"><a class="anchor" id="intra_thompson"></a>
Intraphysics Communication</h1>
<ul>
<li><a class="el" href="group__aathompson_ga370acdf3f9e68e7cd204da816dbbafbc.html#arg_table_mp_thompson_run" title="Argument Table">Argument Table</a></li>
</ul>
<h1 class="doxsection"><a class="anchor" id="gal_thompson"></a>
General Algorithm</h1>
<ul>
<li><a class="el" href="group__aathompson_ga913721b93920f568db16540ff0dac1e9.html#gen_thompson_init" title="thompson_init General Algorithm">thompson_init General Algorithm</a></li>
<li><a class="el" href="group__aathompson_ga370acdf3f9e68e7cd204da816dbbafbc.html#gen_thompson_hrrr" title="Thompson MP General Algorithm">Thompson MP General Algorithm</a></li>
<li><a class="el" href="group__aathompson_ga91f91d9fdb9ec49b853861384a61d70a.html#gen_mpgtdriver" title="Thompson mp_gt_driver General Algorithm">Thompson mp_gt_driver General Algorithm</a></li>
<li><a class="el" href="group__aathompson_gab35ac4001561513747f53afcf6c9ac3b.html#gen_mp_thompson" title="mp_thompson General Algorithm">mp_thompson General Algorithm</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
    toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
    toggleButton.title = "Toggle Light/Dark Mode"
    $(document).ready(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
    // every resize will remove the button, which is why it has to be added again:
    $(window).resize(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
  })
</script>
</body>
</html>
