<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="CCPP SciDoc" />
<meta property="og:image" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta property="og:description" content="CCPP Scientific Documentation" />
<meta property="og:url" content="https://github.com/ufs-community/ccpp-physics" />
<!-- END opengraph metadata -->
<title>CCPP SciDoc v7.0.0: module_ozphys Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-ccpp.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/ufs-community/ccpp-physics" class="github-corner" title="View source on GitHub" target="_blank" rel="noopener noreferrer">
    <svg viewBox="0 0 250 250" width="60" height="60" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="dtc_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CCPP SciDoc v7.0.0
   &#160;<span id="projectnumber">v7.0.0</span>
   </div>
   <div id="projectbrief">Common Community Physics Package Developed at DTC</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('namespacemodule__ozphys.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">module_ozphys Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>The operational GFS currently parameterizes ozone production and destruction based on monthly mean coefficients ( global_o3prdlos.f77) provided by Naval Research Laboratory through CHEM2D chemistry model (McCormack et al. (2006) <a class="el" href="citelist.html#CITEREF_mccormack_et_al_2006">[135]</a>).  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:ty_5Fozphys" id="r_ty_5Fozphys"><td class="memItemLeft">type &#160;</td><td class="memItemRight"><a class="el" href="structmodule__ozphys_1_1ty__ozphys.html">ty_ozphys</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a402f56ee4fda34a860572d8375d54032" id="r_a402f56ee4fda34a860572d8375d54032"><td class="memItemLeft">character(len=128) function&#160;</td><td class="memItemRight"><a class="el" href="namespacemodule__ozphys_a402f56ee4fda34a860572d8375d54032.html#a402f56ee4fda34a860572d8375d54032">load_o3prog</a> (this, file, fileid)</td></tr>
<tr class="memdesc:a402f56ee4fda34a860572d8375d54032"><td class="mdescLeft">&#160;</td><td class="mdescRight">Procedure (type-bound) for loading data for prognostic ozone.  <br /></td></tr>
<tr class="memitem:a5d087e780c1a586b601da4e775763a48" id="r_a5d087e780c1a586b601da4e775763a48"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="namespacemodule__ozphys_a5d087e780c1a586b601da4e775763a48.html#a5d087e780c1a586b601da4e775763a48">setup_o3prog</a> (this, lat, idx1, idx2, idxh)</td></tr>
<tr class="memdesc:a5d087e780c1a586b601da4e775763a48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Procedure (type-bound) for setting up interpolation indices between data-grid and model-grid. Called once during initialization.  <br /></td></tr>
<tr class="memitem:a712e1573797f1ca3a9fb11aa2cfd76c0" id="r_a712e1573797f1ca3a9fb11aa2cfd76c0"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="namespacemodule__ozphys_a712e1573797f1ca3a9fb11aa2cfd76c0.html#a712e1573797f1ca3a9fb11aa2cfd76c0">update_o3prog</a> (this, idx1, idx2, idxh, rjday, idxt1, idxt2, ozpl)</td></tr>
<tr class="memdesc:a712e1573797f1ca3a9fb11aa2cfd76c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Procedure (type-bound) for updating data used in prognostic ozone scheme.  <br /></td></tr>
<tr class="memitem:a5c14ee8f340894eb8c3bce742dfd7d38" id="r_a5c14ee8f340894eb8c3bce742dfd7d38"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="namespacemodule__ozphys_a5c14ee8f340894eb8c3bce742dfd7d38.html#a5c14ee8f340894eb8c3bce742dfd7d38">run_o3prog_2015</a> (this, con_1ovg, dt, p, t, dp, ozpl, oz, do3_dt_prd, do3_dt_ozmx, do3_dt_temp, do3_dt_ohoz)</td></tr>
<tr class="memitem:a9255a6dad1e2b5a739cfffc7c5d586d4" id="r_a9255a6dad1e2b5a739cfffc7c5d586d4"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="namespacemodule__ozphys_a9255a6dad1e2b5a739cfffc7c5d586d4.html#a9255a6dad1e2b5a739cfffc7c5d586d4">run_o3prog_2006</a> (this, con_1ovg, dt, p, t, dp, ozpl, oz, do3_dt_prd, do3_dt_ozmx, do3_dt_temp, do3_dt_ohoz)</td></tr>
<tr class="memitem:abc312ddbdbe3fc56624c1fe4531319dd" id="r_abc312ddbdbe3fc56624c1fe4531319dd"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="namespacemodule__ozphys_abc312ddbdbe3fc56624c1fe4531319dd.html#abc312ddbdbe3fc56624c1fe4531319dd">run_o3clim</a> (this, lat, prslk, con_pi, oz)</td></tr>
<tr class="memdesc:abc312ddbdbe3fc56624c1fe4531319dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Procedure (type-bound) for NRL updating climotological ozone.  <br /></td></tr>
<tr class="memitem:aa487bc772879a53d4735e9eea7545c5f" id="r_aa487bc772879a53d4735e9eea7545c5f"><td class="memItemLeft">character(len=128) function&#160;</td><td class="memItemRight"><a class="el" href="namespacemodule__ozphys_aa487bc772879a53d4735e9eea7545c5f.html#aa487bc772879a53d4735e9eea7545c5f">load_o3clim</a> (this, file, fileid)</td></tr>
<tr class="memdesc:aa487bc772879a53d4735e9eea7545c5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Procedure (type-bound) for loading data for climotological ozone.  <br /></td></tr>
<tr class="memitem:a8ada51e732f4a0419da94d1c72f85aa9" id="r_a8ada51e732f4a0419da94d1c72f85aa9"><td class="memItemLeft">subroutine&#160;</td><td class="memItemRight"><a class="el" href="namespacemodule__ozphys_a8ada51e732f4a0419da94d1c72f85aa9.html#a8ada51e732f4a0419da94d1c72f85aa9">update_o3clim</a> (this, imon, iday, ihour, loz1st)</td></tr>
<tr class="memdesc:a8ada51e732f4a0419da94d1c72f85aa9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Procedure (type-bound) for updating temporal interpolation index when using climotological ozone.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>There are two implementations of this parameterization within this module. run_o3prog_2006 - Relies on either two/four mean monthly coefficients. This is explained in (<a href="https://doi.org/10.5194/acp-6-4943-2006">https://doi.org/10.5194/acp-6-4943-2006</a>. See Eq.(4)). run_o3prog_2015 - Relies on six mean monthly coefficients, specifically for NRL parameterization and climatological T and O3 are in location 5 and 6 of the coefficient array.</p>
<p>Both of these rely on the scheme being setup correctly by invoking the load(), setup(), and update() procedures prior to calling the run() procedure.</p>
<p><a class="el" href="namespacemodule__ozphys_a402f56ee4fda34a860572d8375d54032.html#a402f56ee4fda34a860572d8375d54032" title="Procedure (type-bound) for loading data for prognostic ozone.">load_o3prog()</a> - Read in data and load into type <a class="el" href="structmodule__ozphys_1_1ty__ozphys.html">ty_ozphys</a> (called once from host) <a class="el" href="namespacemodule__ozphys_a5d087e780c1a586b601da4e775763a48.html#a5d087e780c1a586b601da4e775763a48" title="Procedure (type-bound) for setting up interpolation indices between data-grid and model-grid....">setup_o3prog()</a> - Create spatial interpolation indices (called once, after model grid is known) <a class="el" href="namespacemodule__ozphys_a712e1573797f1ca3a9fb11aa2cfd76c0.html#a712e1573797f1ca3a9fb11aa2cfd76c0" title="Procedure (type-bound) for updating data used in prognostic ozone scheme.">update_o3prog()</a> - Update ozone concentration in time (call in physics loop, before run()) <em>CAVEAT</em> Since the radiation is often run at a lower temporal resolution than the rest of the physics, <a class="el" href="namespacemodule__ozphys_a712e1573797f1ca3a9fb11aa2cfd76c0.html#a712e1573797f1ca3a9fb11aa2cfd76c0" title="Procedure (type-bound) for updating data used in prognostic ozone scheme.">update_o3prog()</a> needs to be called before the radiation, which is called before the physics. For example, within the physics loop: <a class="el" href="namespacemodule__ozphys_a712e1573797f1ca3a9fb11aa2cfd76c0.html#a712e1573797f1ca3a9fb11aa2cfd76c0" title="Procedure (type-bound) for updating data used in prognostic ozone scheme.">update_o3prog()</a> -&gt; <a class="el" href="group___noah_m_p___l_s_m_gaaa3073947247829ad606eea763d888f8.html#gaaa3073947247829ad606eea763d888f8" title="Calculate solar radiation: absorbed &amp; reflected by the ground and canopy.">radiation()</a> -&gt; run_o3prog() -&gt; physics....</p>
<p>Additionally, there is the functionality to not use interactive ozone, instead reverting to ozone climatology. In this case, analagous to when using prognostic ozone, there are update() and run() procedures that need to be called before the radiation. For example, within the physics loop: <a class="el" href="namespacemodule__ozphys_a8ada51e732f4a0419da94d1c72f85aa9.html#a8ada51e732f4a0419da94d1c72f85aa9" title="Procedure (type-bound) for updating temporal interpolation index when using climotological ozone.">update_o3clim()</a> -&gt; <a class="el" href="namespacemodule__ozphys_abc312ddbdbe3fc56624c1fe4531319dd.html#abc312ddbdbe3fc56624c1fe4531319dd" title="Procedure (type-bound) for NRL updating climotological ozone.">run_o3clim()</a> -&gt; <a class="el" href="group___noah_m_p___l_s_m_gaaa3073947247829ad606eea763d888f8.html#gaaa3073947247829ad606eea763d888f8" title="Calculate solar radiation: absorbed &amp; reflected by the ground and canopy.">radiation()</a> -&gt; physics...</p>
<dl class="section author"><dt>Author</dt><dd>June 2015 - Shrinivas Moorthi<ul>
<li>Sep 2023 - Dustin Swales </li>
</ul>
</dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="namespacemodule__ozphys.html">module_ozphys</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
    toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
    toggleButton.title = "Toggle Light/Dark Mode"
    $(document).ready(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
    // every resize will remove the button, which is why it has to be added again:
    $(window).resize(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
  })
</script>
</body>
</html>
